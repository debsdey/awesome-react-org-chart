/*! For license information please see vanilla.js.LICENSE.txt */
!function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s="./src/VanillaExample.ts")}({"./dist/Animated.js":function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=a(r("./node_modules/react/index.js")),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={transition:e.props.entranceTransition||"opacity 800ms",opacity:0,firstVisible:!1},e}return o(e,t),e.getDerivedStateFromProps=function(t,e){var r=t.context,n=t.defaultTransition,o=void 0===n?"transform 800ms, opacity 800ms":n,i=t.entranceTransition,a=void 0===i?"opacity 800ms":i;return r.hidden?{opacity:0}:e.firstVisible?{opacity:1,transition:o}:{opacity:1,transition:a,firstVisible:!0}},e.prototype.render=function(){var t=this.props,e=t.node,r=t.context,n=t.props,o=t.getStyle,a=this.state,l=a.opacity,u=a.transition,h=o?o(e,n,r):null;return s.default.createElement("div",i({},n,{style:i(i(i({},n.style),{opacity:l,transition:u}),h)}))},e}(s.default.Component);e.default=l},"./dist/OrgChart.js":function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var l=s(r("./node_modules/react/index.js")),u=r("./dist/core/index.js"),h=new u.Size(5,5),d=function(t){function e(e){var r=t.call(this)||this;return r.DataSource=e,r}return o(e,t),e}(u.Diagram),c=function(t){function e(){var r=null!==t&&t.apply(this,arguments)||this;return r.state={lines:Array(),width:0,height:0,diagram:null,nodes:[],hidden:!0,boundaries:[],prevProps:null,renderIndex:0},r._mounted=!0,r._container=l.default.createRef(),r.onComputeBranchOptimizer=function(t){var n=r.props.layout,o=void 0===n?"linear":n;if(t.IsAssistantRoot){var i=r.props.assistantLayout,a=void 0===i?"assistants":i;return a instanceof u.LayoutStrategyBase?"assistantCustom":a}return"smart"===o?e.getBranchOptimizerSmart(t):"stackers"===o?e.getBranchOptimizerStackers(t):o instanceof u.LayoutStrategyBase?"custom":o},r._lastRenderIndex=0,r}return o(e,t),e.assignStrategies=function(t){var e,r=[];return(e=new u.LinearLayoutStrategy).ParentAlignment=u.BranchParentAlignment.Center,t.LayoutSettings.LayoutStrategies.set("linear",e),r.push(e),(e=new u.MultiLineHangerLayoutStrategy).ParentAlignment=u.BranchParentAlignment.Center,e.MaxSiblingsPerRow=2,t.LayoutSettings.LayoutStrategies.set("hanger2",e),r.push(e),(e=new u.MultiLineHangerLayoutStrategy).ParentAlignment=u.BranchParentAlignment.Center,e.MaxSiblingsPerRow=4,t.LayoutSettings.LayoutStrategies.set("hanger4",e),r.push(e),(e=new u.SingleColumnLayoutStrategy).ParentAlignment=u.BranchParentAlignment.Right,t.LayoutSettings.LayoutStrategies.set("singleColumnRight",e),r.push(e),(e=new u.SingleColumnLayoutStrategy).ParentAlignment=u.BranchParentAlignment.Left,t.LayoutSettings.LayoutStrategies.set("singleColumnLeft",e),r.push(e),(e=new u.MultiLineFishboneLayoutStrategy).ParentAlignment=u.BranchParentAlignment.Center,e.MaxGroups=1,t.LayoutSettings.LayoutStrategies.set("fishbone1",e),r.push(e),(e=new u.MultiLineFishboneLayoutStrategy).ParentAlignment=u.BranchParentAlignment.Center,e.MaxGroups=2,t.LayoutSettings.LayoutStrategies.set("fishbone2",e),r.push(e),(e=new u.StackingLayoutStrategy).ParentAlignment=u.BranchParentAlignment.InvalidValue,e.Orientation=u.StackOrientation.SingleRowHorizontal,e.ParentChildSpacing=10,t.LayoutSettings.LayoutStrategies.set("hstack",e),r.push(e),(e=new u.StackingLayoutStrategy).ParentAlignment=u.BranchParentAlignment.InvalidValue,e.Orientation=u.StackOrientation.SingleColumnVertical,e.ParentChildSpacing=10,t.LayoutSettings.LayoutStrategies.set("vstack",e),r.push(e),(e=new u.StackingLayoutStrategy).ParentAlignment=u.BranchParentAlignment.InvalidValue,e.Orientation=u.StackOrientation.SingleColumnVertical,e.SiblingSpacing=20,t.LayoutSettings.LayoutStrategies.set("vstackMiddle",e),r.push(e),(e=new u.StackingLayoutStrategy).ParentAlignment=u.BranchParentAlignment.InvalidValue,e.Orientation=u.StackOrientation.SingleColumnVertical,e.SiblingSpacing=50,t.LayoutSettings.LayoutStrategies.set("vstackTop",e),r.push(e),(e=new u.FishboneAssistantsLayoutStrategy).ParentAlignment=u.BranchParentAlignment.Center,t.LayoutSettings.LayoutStrategies.set("assistants",e),r.push(e),t.LayoutSettings.DefaultLayoutStrategyId="vstack",t.LayoutSettings.DefaultAssistantLayoutStrategyId="assistants",r},e.getDataSource=function(t){var e=t.root,r=t.childNodesGetter,n=t.keyGetter,o=t.isAssistantGetter,i=new Map,s=[],l=function(t,e){var u,h;void 0===e&&(e=null);var d=n(t);s.push(d);var c=!!o&&o(t);i.set(d,{IsAssistant:c,Id:d,data:t,parentKey:e});try{for(var f=a(r(t)),S=f.next();!S.done;S=f.next()){var p=S.value;l(p,d)}}catch(t){u={error:t}}finally{try{S&&!S.done&&(h=f.return)&&h.call(f)}finally{if(u)throw u.error}}};l(e,null);return{GetDataItemFunc:function(t){return function(t){var e=i.get(t);if(null==e)throw Error("Could not find item");return e}(t)},GetParentKeyFunc:function(t){var e;return(null===(e=i.get(t))||void 0===e?void 0:e.parentKey)||null},AllDataItemIds:s}},e.getBranchOptimizerStackers=function(t){return t.IsAssistantRoot?null:0===t.Level?"vstackTop":1===t.Level?"vstackMiddle":"hstack"},e.getBranchOptimizerSmart=function(t){if(t.IsAssistantRoot)return null;var e=t.ChildCount;if(e<=1)return"vstack";for(var r=0,n=0;n<e;n++)t.Children[n].ChildCount>0&&r++;return r<=1?e<=4?"vstack":e<=8?"fishbone1":"fishbone2":"hanger4"},e.prototype.componentWillUnmount=function(){this._mounted=!0},e.getDerivedStateFromProps=function(t,r){if(t!==r.prevProps){var n=e.createDiagram(t),o=e.getPlaceholders(n,r.nodes);return i(i({diagram:n},o),{prevProps:t,renderIndex:r.renderIndex+1})}return{prevProps:t}},e.prototype.componentWillMount=function(){var t=e.getDerivedStateFromProps(this.props,this.state);this.setState(t)},e.prototype.componentWillReceiveProps=function(t){if(t!==this.props){var r=e.getDerivedStateFromProps(t,this.state);this.setState(r)}},e.createDiagram=function(t){var r,n,o=t.layout,i=t.assistantLayout,s=t.parentSpacing,l=void 0===s?40:s,h=t.siblingSpacing,c=void 0===h?30:h,f=e.getDataSource(t),S=new u.BoxContainer(f),p=new d(f);p.Boxes=S;var g=e.assignStrategies(p);o instanceof u.LayoutStrategyBase&&p.LayoutSettings.LayoutStrategies.set("custom",o),i instanceof u.LayoutStrategyBase&&p.LayoutSettings.LayoutStrategies.set("assistantCustom",i);try{for(var m=a(g),y=m.next();!y.done;y=m.next()){var b=y.value;b.ChildConnectorHookLength=l/2,b.ParentChildSpacing=l,b.SiblingSpacing=c}}catch(t){r={error:t}}finally{try{y&&!y.done&&(n=m.return)&&n.call(m)}finally{if(r)throw r.error}}return p},e.getPlaceholders=function(t,e){var r,n,o,i,s=t.DataSource,l=[],u=new Map;try{for(var h=a(e),d=h.next();!d.done;d=h.next()){var c=d.value;u.set(c.dataId,c)}}catch(t){r={error:t}}finally{try{d&&!d.done&&(n=h.return)&&n.call(h)}finally{if(r)throw r.error}}var f={left:0,top:0,width:"",height:""};try{for(var S=a(t.Boxes.BoxesById.values()),p=S.next();!p.done;p=S.next()){var g=p.value;if(g.IsDataBound){var m=g.Id,y=g.DataId||"",b=s.GetDataItemFunc(y).data,C=u.get(y),v=(null==C?void 0:C.rect)||f;l.push({rect:{left:v.left,top:v.top,width:"auto",height:"auto"},data:b,dataId:g.DataId||String(m),boxId:m,assistant:g.IsAssistant})}}}catch(t){o={error:t}}finally{try{p&&!p.done&&(i=S.return)&&i.call(S)}finally{if(o)throw o.error}}return l.sort((function(t,e){return t.boxId-e.boxId})),{hidden:!0,nodes:l}},e.prototype.safelyDrawDiagram=function(){if(this.props===this.state.prevProps&&this._mounted){var t=this.state,e=t.diagram,r=t.renderIndex,n=this.props.debug;r>this._lastRenderIndex&&(this._lastRenderIndex=r,e&&this.drawDiagram(e,n))}},e.prototype.componentDidMount=function(){this.safelyDrawDiagram()},e.prototype.componentDidUpdate=function(){this.safelyDrawDiagram()},e.prototype.drawDiagram=function(t,e){if(t===this.state.diagram&&0!==t.DataSource.AllDataItemIds.length){var r=new u.LayoutState(t),n=new Map,o=this._container.current;if(o&&o.querySelectorAll("[data-box-id]").forEach((function(t){var e=t.getAttribute("data-box-id");e&&n.set(parseInt(e),t)})),r.LayoutOptimizerFunc=this.onComputeBranchOptimizer,r.BoxSizeFunc=function(e){if(null==e)return h;var r=t.Boxes.BoxesByDataId.get(e);if(r){var o=n.get(r.Id);if(o){o.offsetWidth,o.offsetHeight;var i=o.getBoundingClientRect();return new u.Size(i.width,i.height)}}return h},u.LayoutAlgorithm.Apply(r),null==t.VisualTree)throw Error("VisualTree is null");var i=u.LayoutAlgorithm.ComputeBranchVisualBoundingRect(t.VisualTree),a=-i.Left,s=-i.Top,l=[],d=[],c=[];t.VisualTree.IterateParentFirst((function(r){if(r.State.IsHidden)return!1;var n=r.Element;if(!n.IsDataBound)return!0;var o=r.State.TopLeft.X+a,i=r.State.TopLeft.Y+s,u=n.DataId||"",h=t.DataSource.GetDataItemFunc(u).data;if(l.push({rect:{left:o,top:i,width:n.Size.Width,height:n.Size.Height},data:h,dataId:u||String(n.Id),boxId:n.Id,assistant:n.IsAssistant}),e&&c.push({branchLeft:r.State.BranchExterior.Left,branchTop:r.State.BranchExterior.Top,left:r.State.BranchExterior.Left+a,top:r.State.BranchExterior.Top+s,width:r.State.BranchExterior.Size.Width,height:r.State.BranchExterior.Size.Height}),null!=r.State.Connector)for(var f=r.State.Connector.Segments,S=0;S<f.length;S++){var p=f[S],g="horizontal",m=n.IsAssistant,y=void 0,b=0,C=0;p.From.Y===p.To.Y?(g="horizontal",C=1,p.From.X<p.To.X?(y=p.From,b=p.To.X-p.From.X):(y=p.To,b=p.From.X-p.To.X)):(g="vertical",p.From.Y<p.To.Y?(y=p.From,C=p.To.Y-p.From.Y):(y=p.To,C=p.From.Y-p.To.Y)),d.push({direction:g,assistant:m,data:h,dataId:u,boxId:n.Id,index:S,rect:{left:y.X+a,top:y.Y+s,width:b,height:C}})}return!0})),this.setState({width:i.Size.Width,height:i.Size.Height,lines:d,nodes:l,boundaries:c,hidden:!1})}},e.prototype.render=function(){var t=this.state,e=t.lines,r=t.width,n=t.height,o=t.nodes,a=t.hidden,s=t.boundaries,u=this.props,h=u.lineVerticalClassName,d=u.lineHorizontalClassName,c=u.lineHorizontalStyle,f=u.lineVerticalStyle,S=u.containerStyle,p=u.renderNode,g=u.renderNodeContainer,m=u.renderNodeLine,y=u.nodeContainerStyle,b=u.isValidNode,C={vertical:h,horizontal:d},v={vertical:f,horizontal:c};return l.default.createElement("div",{style:i({width:r,height:n,position:"relative"},S),ref:this._container},l.default.createElement("div",null,e.map((function(t){var e=t.rect,r=e.width,n=e.height,o=e.left,s=e.top,u=t.data,h=t.assistant,d=t.direction,c=t.dataId,f=t.index;if(!b(c))return null;var S={"data-line-assistant":h,"data-line-direction":d,className:C[d],key:c+"-"+f,style:i({left:0,top:0,width:r,height:n,transform:"translate3d("+o+"px, "+s+"px, 0)",position:"absolute"},v[d])};return"function"==typeof m?m(u,S,{hidden:a,direction:d}):(S.style.visibility=a?"hidden":"visible",S.style.pointerEvents=a?"none":"auto",l.default.createElement("div",i({},S)))}))),l.default.createElement("div",null,o.map((function(t){var e=t.rect,r=e.top,n=e.left,o=(e.width,e.height,t.dataId),s=t.boxId,u=t.data;if(!b(o))return null;var h=p(u),d={"data-box-id":String(s),children:h,key:o,style:i({left:0,top:0,transform:"translate3d("+n+"px, "+r+"px, 0)",position:"absolute"},y)};return"function"==typeof g?g(u,d,{hidden:a}):(d.style.visibility=a?"hidden":"visible",d.style.pointerEvents=a?"none":"auto",l.default.createElement("div",i({},d)))}))),l.default.createElement("div",null,s.map((function(t,e){var r=t.top,n=t.left,o=t.width,i=t.height,s=t.branchLeft,u=t.branchTop;return l.default.createElement("div",{key:e,style:{transform:"translate3d("+n+"px, "+r+"px, 0)",width:o,height:i,position:"absolute",top:0,left:0,zIndex:0,pointerEvents:"none",visibility:a?"hidden":"visible",background:"rgba(255,0,0,0.1)",border:"1px solid red"}},l.default.createElement("div",{style:{backgroundColor:"red",color:"white",display:"inline-block",padding:"0 2px"}},"(",+s.toFixed(2),",",+u.toFixed(2),")"," ",+o.toFixed(2),"x",+i.toFixed(2)))}))))},e}(l.default.Component);e.default=c},"./dist/core/Boundary.js":function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(r("./dist/core/Step.js")),i=n(r("./dist/core/Rect.js")),a=n(r("./dist/core/Size.js")),s=n(r("./dist/core/Point.js")),l=n(r("./dist/core/LayoutAlgorithm.js")),u=function(){function t(e){void 0===e&&(e=!0),this._spacerMerger=null,this._boundingRect=null,this.Left=[],this.Right=[],e&&(this._spacerMerger=new t(!1))}return Object.defineProperty(t.prototype,"BoundingRect",{get:function(){if(null==this._boundingRect)throw Error("BoundingRect is null");return this._boundingRect},set:function(t){this._boundingRect=t},enumerable:!1,configurable:!0}),t.prototype.PrepareForHorizontalLayout=function(t){if(this.Prepare(t),!t.Element.DisableCollisionDetection){var e=t.State;this.Left.push(new o.default(t,e.Left,e.Top,e.Bottom)),this.Right.push(new o.default(t,e.Right,e.Top,e.Bottom))}},t.prototype.Prepare=function(t){this.Left=[],this.Right=[],this.BoundingRect=i.default.from(t.State.Size,t.State.TopLeft)},t.prototype.VerticalMergeFrom=function(t){this.BoundingRect=i.default.add(this.BoundingRect,t.BoundingRect)},t.prototype.MergeFrom=function(t){if(t.BoundingRect.Top>=t.BoundingRect.Bottom)throw new Error("Cannot merge boundary of height "+(t.BoundingRect.Bottom-t.BoundingRect.Top));for(var e="r";"\0"!=e;){for(var r="r"==e?this.Right:this.Left,n="r"==e?t.Right:t.Left,a=0,s=0;s<n.length&&a<r.length;){var u=r[a],h=n[s];if(u.Bottom<=h.Top)a++;else if(h.Bottom<=u.Top)r.splice(a,0,h),s++,this.ValidateState();else{var d="r"==e?u.X<=h.X:u.X>=h.X;l.default.IsEqual(u.Top,h.Top)?l.default.IsEqual(u.Bottom,h.Bottom)?(d&&(r[a]=h),a++,s++,this.ValidateState()):u.Bottom<h.Bottom?(d&&(r[a]=u.ChangeOwner(h.Node,h.X)),n[s]=h.ChangeTop(u.Bottom),a++,this.ValidateState()):(d&&(r[a]=u.ChangeTop(h.Bottom),r.splice(a,0,h),a++),s++,this.ValidateState()):l.default.IsEqual(u.Bottom,h.Bottom)?u.Top<h.Top?(d&&(r[a]=u.ChangeBottom(h.Top),r.splice(a+1,0,h),a++),a++,s++,this.ValidateState()):(d?r[a]=h:(r.splice(a,0,h.ChangeBottom(u.Top)),a++),a++,s++,this.ValidateState()):u.Top<h.Top&&u.Bottom<h.Bottom?(d&&(r[a]=u.ChangeBottom(h.Top),r.splice(a+1,0,new o.default(h.Node,h.X,h.Top,u.Bottom)),a++),n[s]=h.ChangeTop(u.Bottom),a++,this.ValidateState()):u.Top<h.Top&&u.Bottom>h.Bottom?(d&&(r[a]=u.ChangeBottom(h.Top),r.splice(a+1,0,h),r.splice(a+2,0,u.ChangeTop(h.Bottom)),a+=2),s++,this.ValidateState()):u.Bottom>h.Bottom?(d?(r[a]=u.ChangeTop(h.Bottom),r.splice(a,0,h)):r.splice(a,0,h.ChangeBottom(u.Top)),a++,s++,this.ValidateState()):(d?r[a]=h.ChangeBottom(u.Bottom):(r.splice(a,0,h.ChangeBottom(u.Top)),a++),n[s]=h.ChangeTop(u.Bottom),a++,this.ValidateState())}}if(a==r.length)for(;s<n.length;)r.push(n[s]),s++,this.ValidateState();e="r"==e?"l":"\0"}this.BoundingRect=i.default.add(this.BoundingRect,t.BoundingRect)},t.prototype.ValidateState=function(){for(var t=1;t<this.Left.length;t++)if(this.Left[t].Top==this.Left[t].Bottom||this.Left[t].Top<this.Left[t-1].Bottom||this.Left[t].Top<=this.Left[t-1].Top||this.Left[t].Bottom<=this.Left[t].Top||this.Left[t].Bottom<=this.Left[t-1].Bottom)throw new Error("State error at Left index "+t);for(t=1;t<this.Right.length;t++)if(this.Right[t].Top==this.Right[t].Bottom||this.Right[t].Top<this.Right[t-1].Bottom||this.Right[t].Top<=this.Right[t-1].Top||this.Right[t].Bottom<=this.Right[t].Top||this.Right[t].Bottom<=this.Right[t-1].Bottom)throw new Error("State error at Right index "+t)},t.prototype.MergeFromNode=function(t){if(!t.Element.DisableCollisionDetection&&t.State.Size&&!l.default.IsZero(t.State.Size.Height)){if(null==this._spacerMerger)throw Error("SpaceMerger is null");this._spacerMerger.PrepareForHorizontalLayout(t),this.MergeFrom(this._spacerMerger)}},t.prototype.ComputeOverlap=function(t,e,r){for(var n=0,o=0,i=0;n<this.Right.length&&o<t.Left.length;){var a=this.Right[n],s=t.Left[o];if(a.Bottom<=s.Top)n++;else if(s.Bottom<=a.Top)o++;else{if(!a.Node.Element.DisableCollisionDetection&&!s.Node.Element.DisableCollisionDetection){var l=a.Node.Element.IsSpecial||s.Node.Element.IsSpecial?0:a.Node.Element.ParentId==s.Node.Element.ParentId?e:r,u=a.X+l-s.X;u>i&&(i=u)}a.Bottom>=s.Bottom&&o++,s.Bottom>=a.Bottom&&n++}}return i},t.prototype.ReloadFromBranch=function(t){for(var e=Number.MAX_VALUE,r=Number.MIN_VALUE,n=0;n<this.Left.length;n++){var o=this.Left[n],l=o.Node.State.Left;this.Left[n]=o.ChangeX(l),e=Math.min(e,l)}for(n=0;n<this.Right.length;n++){var u=this.Right[n],h=u.Node.State.Right;this.Right[n]=u.ChangeX(h),r=Math.max(r,h)}e=Math.min(t.State.Left,e),r=Math.max(t.State.Right,r),this.BoundingRect=i.default.from(new a.default(r-e,this.BoundingRect.Size.Height),new s.default(e,this.BoundingRect.Top))},t}();e.default=u},"./dist/core/BoundaryChangedEventArgs.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t,e,r){this.Boundary=t,this.LayoutLevel=e,this.State=r};e.default=n},"./dist/core/Box.js":function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(r("./dist/core/Size.js")),i=function(){function t(t,e,r,n,i,a){if(0==e)throw new Error("Invalid "+e);this.Id=e,this.ParentId=r,this.DataId=t,this.IsSpecial=n,this.IsAssistant=a,this.DisableCollisionDetection=i,this.AssistantLayoutStrategyId=null,this.LayoutStrategyId=null,this.IsCollapsed=!1,this.Size=new o.default(0,0)}return Object.defineProperty(t.prototype,"IsDataBound",{get:function(){return!!this.DataId},enumerable:!1,configurable:!0}),t.Special=function(e,r,n){return new t(null,e,r,!0,n,!1)},t.None=-1,t}();e.default=i},"./dist/core/BoxContainer.js":function(t,e,r){"use strict";var n=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=o(r("./dist/core/Box.js")),a=function(){function t(t){this._lastBoxId=0,this._boxesById=new Map,this._boxesByDataId=new Map,this.SystemRoot=null,t&&this.ReloadBoxes(t)}return Object.defineProperty(t.prototype,"BoxesById",{get:function(){return this._boxesById},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"BoxesByDataId",{get:function(){return this._boxesByDataId},enumerable:!1,configurable:!0}),t.prototype.ReloadBoxes=function(t){var e,r,o,a;this._boxesByDataId.clear(),this._boxesById.clear(),this._lastBoxId=0,this.SystemRoot=i.default.Special(++this._lastBoxId,i.default.None,!0),this._boxesById.set(this.SystemRoot.Id,this.SystemRoot);var s=new Map;try{for(var l=n(t.AllDataItemIds),u=l.next();!u.done;u=l.next()){var h=u.value;s.set(h,this.NextBoxId())}}catch(t){e={error:t}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(e)throw e.error}}var d=t.GetDataItemFunc;try{for(var c=n(t.AllDataItemIds),f=c.next();!f.done;f=c.next()){var S=(h=f.value)?t.GetParentKeyFunc(h):null,p=S?s.get(S):this.SystemRoot.Id,g=s.get(h);null!=g&&null!=p&&this._AddBox(h,g,p,d(h).IsAssistant)}}catch(t){o={error:t}}finally{try{f&&!f.done&&(a=c.return)&&a.call(c)}finally{if(o)throw o.error}}},t.prototype.AddBox=function(t,e,r){return this._AddBox(t,this.NextBoxId(),e,r)},t.prototype._AddBox=function(t,e,r,n){var o=new i.default(t,e,r,!1,!1,n);return this._boxesById.set(o.Id,o),o.DataId&&this._boxesByDataId.set(o.DataId,o),o},t.prototype.NextBoxId=function(){return this._lastBoxId++,this._lastBoxId},t}();e.default=a},"./dist/core/BoxTree.js":function(t,e,r){"use strict";var n=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=o(r("./dist/core/Box.js")),a=o(r("./dist/core/Node.js")),s=function(){function t(){this.Depth=0,this.Root=null,this.Nodes=new Map}return t.prototype.IterateChildFirst=function(t){if(null==this.Root)throw Error("Root is null");return this.Root.IterateChildFirst(t)},t.prototype.IterateParentFirst=function(t,e){if(null==this.Root)throw Error("Root is null");this.Root.IterateParentFirst(t,e)},t.prototype.UpdateHierarchyStats=function(){var t=this;this.Depth=0,this.IterateParentFirst((function(e){return null!=e.ParentNode?(e.Level=e.ParentNode.Level,e.ParentNode.IsAssistantRoot||(e.Level=e.Level+1),t.Depth=Math.max(1+e.Level,t.Depth)):(e.Level=0,t.Depth=1),!0}))},t.Build=function(e){var r,o,s,l,u,h=new t;try{for(var d=n(e.Diagram.Boxes.BoxesById.values()),c=d.next();!c.done;c=d.next()){u=c.value;var f=new a.default(u);h.Nodes.set(u.Id,f)}}catch(t){r={error:t}}finally{try{c&&!c.done&&(o=d.return)&&o.call(d)}finally{if(r)throw r.error}}try{for(var S=n(h.Nodes.values()),p=S.next();!p.done;p=S.next()){var g=(f=p.value).Element.ParentId,m=h.Nodes.get(g);if(m)f.Element.IsAssistant&&m.Element.ParentId!=i.default.None?m.AddAssistantChild(f):m.AddRegularChild(f);else{if(null!=h.Root)throw new Error("InvalidOperationException: More then one root found: "+f.Element.Id);h.Root=f}}}catch(t){s={error:t}}finally{try{p&&!p.done&&(l=S.return)&&l.call(S)}finally{if(s)throw s.error}}return h},t}();e.default=s},"./dist/core/BranchParentAlignment.js":function(t,e,r){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.InvalidValue=0]="InvalidValue",t[t.Left=1]="Left",t[t.Center=2]="Center",t[t.Right=3]="Right"}(n||(n={})),e.default=n},"./dist/core/Connector.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){if(0==t.length)throw new Error("Need at least one segment");this.Segments=t};e.default=n},"./dist/core/Diagram.js":function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(r("./dist/core/DiagramLayoutSettings.js")),i=function(){function t(){this._visualTree=null,this._boxes=null,this.LayoutSettings=new o.default}return Object.defineProperty(t.prototype,"Boxes",{get:function(){if(null==this._boxes)throw Error("Boxes is null");return this._boxes},set:function(t){this._visualTree=null,this._boxes=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"VisualTree",{get:function(){return this._visualTree},set:function(t){this._visualTree=t},enumerable:!1,configurable:!0}),t}();e.default=i},"./dist/core/DiagramLayoutSettings.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){this.BranchSpacing=50,this.DefaultAssistantLayoutStrategyId=null,this.DefaultLayoutStrategyId=null,this.BranchSpacing=50,this.LayoutStrategies=new Map}return t.prototype.RequireDefaultLayoutStrategy=function(){var t=this.DefaultLayoutStrategyId;if(!t)throw new Error("DefaultLayoutStrategyId is null or not valid");var e=this.LayoutStrategies.get(t);if(!e)throw new Error("DefaultLayoutStrategyId is null or not valid");return e},t.prototype.RequireDefaultAssistantLayoutStrategy=function(){var t=this.DefaultAssistantLayoutStrategyId;if(!t)throw new Error("RequireDefaultAssistantLayoutStrategy is null or not valid");var e=this.LayoutStrategies.get(t);if(!e)throw new Error("RequireDefaultAssistantLayoutStrategy is null or not valid");return e},t}();e.default=n},"./dist/core/DiagramLayoutTemplates.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){};e.default=n},"./dist/core/Dimensions.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){this.From=t,this.To=e}return t.MinMax=function(){return new t(Number.MAX_VALUE,Number.MIN_VALUE)},t.add=function(e,r){return new t(Math.min(e.From,r.From),Math.max(e.To,r.To))},t}();e.default=n},"./dist/core/Edge.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t,e){this.From=t,this.To=e};e.default=n},"./dist/core/FishboneAssistantsLayoutStrategy.js":function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=i(r("./dist/core/LayoutStrategyBase.js")),s=i(r("./dist/core/Box.js")),l=i(r("./dist/core/Dimensions.js")),u=i(r("./dist/core/LayoutAlgorithm.js")),h=i(r("./dist/core/Rect.js")),d=i(r("./dist/core/Edge.js")),c=i(r("./dist/core/Point.js")),f=i(r("./dist/core/Connector.js")),S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.GetSupportsAssistants=function(){return!1},e.MaxOnLeft=function(t){return Math.floor(t.State.NumberOfSiblings/2)+t.State.NumberOfSiblings%2},e.NeedCarrierProtector=function(t){var e;return 0==(null===(e=t.ParentNode)||void 0===e?void 0:e.ChildCount)},e}return o(e,t),e.prototype.PreProcessThisNode=function(t,e){if(e.State.NumberOfSiblings=e.ChildCount,e.State.NumberOfSiblings>0){e.State.NumberOfSiblingColumns=1,e.State.NumberOfSiblingRows=Math.floor(e.State.NumberOfSiblings/2),e.State.NumberOfSiblings%2!=0&&e.State.NumberOfSiblingRows++;var r=s.default.Special(s.default.None,e.Element.Id,!1);e.AddRegularChildBox(r)}},e.prototype.ApplyVerticalLayout=function(t,e){var r=e.BranchRoot;if(0==r.Level)throw new Error("Should never be invoked on root node");if(null==r.State.SiblingsRowV)throw Error("SiblingsRowV is null");for(var n=r.State.SiblingsRowV.To,o=this.MaxOnLeft(r),i=0;i<o;i++){var a=0==i?this.ParentChildSpacing:this.SiblingSpacing,s=r.Children[i],d=s.State;u.default.MoveTo(d,d.Left,n+a);var c=new l.default(d.Top,d.Bottom),f=i+o;if(null==d.Size)throw Error("Size is null");if(f<r.State.NumberOfSiblings){var S=r.Children[f],p=S.State;if(u.default.MoveTo(p,p.Left,n+a),null==p.Size)throw Error("Size is null");p.Bottom>d.Bottom?u.default.MoveTo(d,d.Left,p.CenterV-d.Size.Height/2):p.Bottom<d.Bottom&&u.default.MoveTo(p,p.Left,d.CenterV-p.Size.Height/2),p.BranchExterior=h.default.from(p.Size,p.TopLeft),c=l.default.add(c,new l.default(p.Top,p.Bottom)),p.SiblingsRowV=c,u.default.VerticalLayout(t,S),n=p.BranchExterior.Bottom}d.BranchExterior=h.default.from(d.Size,d.TopLeft),d.SiblingsRowV=c,u.default.VerticalLayout(t,s),n=Math.max(n,d.BranchExterior.Bottom)}},e.prototype.ApplyHorizontalLayout=function(t,e){var r=e.BranchRoot;0==r.Level&&(r.State.SiblingsRowV=new l.default(r.State.Top,r.State.Bottom));for(var n=!0,o=0,i=this.MaxOnLeft(r),a=0;a<r.State.NumberOfSiblings;a++){var s=r.Children[a];if(u.default.HorizontalLayout(t,s),++o==i&&n){u.default.AlignHorizontalCenters(t,e,this.EnumerateSiblings(r,0,i)),n=!1,o=0;for(var h=Number.MIN_VALUE,d=0;d<=a;d++)h=Math.max(h,r.Children[d].State.BranchExterior.Right);if(r.State.NumberOfSiblings%2!=0)h=Math.max(h,s.State.Right);else{var c=r.Children[r.State.NumberOfSiblings-1];h=c.Element.IsCollapsed||0==c.ChildCount?Math.max(h,s.State.Right):Math.max(h,s.State.BranchExterior.Right)}var f=r.Children[r.State.NumberOfSiblings];u.default.AdjustSpacer(f.State,h,r.State.Bottom,this.ParentConnectorShield,r.State.BranchExterior.Bottom-r.State.Bottom),e.Boundary.MergeFromNode(f)}}if(u.default.AlignHorizontalCenters(t,e,this.EnumerateSiblings(r,i,r.State.NumberOfSiblings)),r.Level>0&&r.State.NumberOfSiblings>0){var S=r.Children[r.State.NumberOfSiblings].State.CenterH,p=r.State.CenterH-S;u.default.MoveChildrenOnly(t,e,p)}},e.prototype.RouteConnectors=function(t,e){var r=e.State.NumberOfSiblings;if(0!=r){this.NeedCarrierProtector(e)&&r++;for(var n=[],o=0,i=this.MaxOnLeft(e),a=e.Children[e.State.NumberOfSiblings].State,s=a.CenterH,l=!0,u=0,h=Number.MIN_VALUE,S=0;S<e.State.NumberOfSiblings;S++){var p=l?e.Children[S].State.Right:e.Children[S].State.Left,g=e.Children[S].State.CenterV;h=Math.max(h,g),n[o++]=new d.default(new c.default(s,g),new c.default(p,g)),++u==i&&(u=0,l=!l)}this.NeedCarrierProtector(e)&&(n[e.State.NumberOfSiblings]=new d.default(new c.default(a.CenterH,a.Top),new c.default(a.CenterH,h))),e.State.Connector=new f.default(n)}},e.prototype.EnumerateSiblings=function(t,e,r){for(var n=[],o=e;o<r;o++)n.push(t.Children[o]);return n},e}(a.default);e.default=S},"./dist/core/LayoutAlgorithm.js":function(t,e,r){"use strict";var n=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(n(arguments[e]));return t},i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=a(r("./dist/core/Rect.js")),l=a(r("./dist/core/BoxTree.js")),u=a(r("./dist/core/Operation.js")),h=a(r("./dist/core/Point.js")),d=a(r("./dist/core/Dimensions.js")),c=a(r("./dist/core/Size.js")),f=r("./dist/core/Utils.js"),S=function(){function t(){}return t.ComputeBranchVisualBoundingRect=function(t){var e=new s.default(0,0,0,0),r=!1;if(null==t.Root)throw Error("Root is null");return t.Root.IterateParentFirst((function(t){var n=t.Element;if(!t.State.IsHidden&&!n.IsSpecial){if(null==t.State.Size)throw Error("Size is null");if(null==t.State.TopLeft)throw Error("TopLeft is null");r?e=s.default.add(e,s.default.from(t.State.Size,t.State.TopLeft)):(r=!0,e=s.default.from(t.State.Size,t.State.TopLeft))}return!n.IsCollapsed})),e},t.Apply=function(e){var r,n,a,d,c,f;if(e.Diagram.Boxes&&null==e.Diagram.Boxes.SystemRoot)throw new Error("SystemRoot is not initialized on the box container");e.CurrentOperation=u.default.Preparing;var S=l.default.Build(e);if(e.Diagram.VisualTree=S,null==S.Root||e.Diagram.Boxes&&S.Root.Element.Id!=(null===(c=e.Diagram.Boxes.SystemRoot)||void 0===c?void 0:c.Id))throw new Error("SystemRoot is not on the top of the visual tree");if(S.UpdateHierarchyStats(),e.AttachVisualTree(S),S.IterateParentFirst((function(t){return t.State.IsHidden=null!=t.ParentNode&&(t.ParentNode.State.IsHidden||t.ParentNode.Element.IsCollapsed),!0})),e.CurrentOperation=u.default.PreprocessVisualTree,null!=e.BoxSizeFunc)try{for(var p=i(o(null===(f=e.Diagram.Boxes)||void 0===f?void 0:f.BoxesById.values()).filter((function(t){return t.IsDataBound}))),g=p.next();!g.done;g=p.next()){(b=g.value).Size=e.BoxSizeFunc(b.DataId)}}catch(t){r={error:t}}finally{try{g&&!g.done&&(n=p.return)&&n.call(p)}finally{if(r)throw r.error}}try{for(var m=i(e.Diagram.Boxes.BoxesById.values()),y=m.next();!y.done;y=m.next()){var b=y.value;this.AssertBoxSize(b)}}catch(t){a={error:t}}finally{try{y&&!y.done&&(d=m.return)&&d.call(m)}finally{if(a)throw a.error}}S.IterateParentFirst((function(e){return t.MoveTo(e.State,0,0),e.State.Size=e.Element.Size,e.State.BranchExterior=s.default.from(e.Element.Size,new h.default(0,0)),!0})),this.PreprocessVisualTree(e,S),S.UpdateHierarchyStats(),e.CurrentOperation=u.default.VerticalLayout,this.VerticalLayout(e,S.Root),e.CurrentOperation=u.default.HorizontalLayout,this.HorizontalLayout(e,S.Root),e.CurrentOperation=u.default.ConnectorsLayout,this.RouteConnectors(e,S),e.CurrentOperation=u.default.Completed},t.AssertBoxSize=function(t){if(!(t.Size.Width>=0&&t.Size.Width<=1e9&&t.Size.Height>=0&&t.Size.Width<=1e9))throw new Error("Box "+t.Id+" has invalid size: "+t.Size.Width+"x"+t.Size.Height)},t.PreprocessVisualTree=function(t,e){var r=t.Diagram.LayoutSettings.RequireDefaultLayoutStrategy(),n=t.Diagram.LayoutSettings.RequireDefaultAssistantLayoutStrategy(),o=[];o.push(r);var i=[];i.push(n),e.IterateParentFirst((function(e){var r;if(e.State.IsHidden)return!1;var n=null;if(null!=t.LayoutOptimizerFunc){var a=t.LayoutOptimizerFunc(e);a&&(n=t.Diagram.LayoutSettings.LayoutStrategies.get(a))}if(e.IsAssistantRoot){if(null==n&&(n=null!=(null===(r=e.ParentNode)||void 0===r?void 0:r.Element.AssistantLayoutStrategyId)?t.Diagram.LayoutSettings.LayoutStrategies.get(e.ParentNode.Element.AssistantLayoutStrategyId):f.peek(i)),null==n)throw Error("Strategy is null. Maybe it allows null?");i.push(n)}else{if(null==n&&(n=null!=e.Element.LayoutStrategyId?t.Diagram.LayoutSettings.LayoutStrategies.get(e.Element.LayoutStrategyId):f.peek(o)),null==n)throw Error("Strategy is null. Maybe it allows null?");o.push(n),n.SupportsAssistants||e.SuppressAssistants()}return e.State.EffectiveLayoutStrategy=n,e.State.RequireLayoutStrategy.PreProcessThisNode(t,e),!e.Element.IsCollapsed&&e.ChildCount>0||null!=e.AssistantsRoot}),(function(t){t.State.IsHidden||(t.IsAssistantRoot?i.pop():o.pop())}))},t.HorizontalLayout=function(t,e){if(e.State.IsHidden)throw new Error("Branch root "+e.Element.Id+" does not affect layout");var r=t.PushLayoutLevel(e);try{(0==e.Level||(e.State.NumberOfSiblings>0||null!=e.AssistantsRoot)&&!e.Element.IsCollapsed)&&e.State.RequireLayoutStrategy.ApplyHorizontalLayout(t,r)}finally{t.PopLayoutLevel()}},t.VerticalLayout=function(t,e){if(e.State.IsHidden)throw new Error("Branch root "+e.Element.Id+" does not affect layout");var r=t.PushLayoutLevel(e);try{(0==e.Level||(e.State.NumberOfSiblings>0||null!=e.AssistantsRoot)&&!e.Element.IsCollapsed)&&e.State.RequireLayoutStrategy.ApplyVerticalLayout(t,r)}finally{t.PopLayoutLevel()}},t.RouteConnectors=function(t,e){e.IterateParentFirst((function(e){return!(e.Element.IsCollapsed||0==e.State.NumberOfSiblings&&null==e.AssistantsRoot)&&(0==e.Level||!(e.Element.IsSpecial&&!e.IsAssistantRoot)&&(e.State.RequireLayoutStrategy.RouteConnectors(t,e),!0))}))},t.MoveChildrenOnly=function(t,e,r){var n,o,a=e.BranchRoot.Children;if(null==a||0==a.length)throw new Error("Should never be invoked when children not set");var s=function(t){if(!t.State.IsHidden)try{t.State.TopLeft=t.State.TopLeft.MoveH(r),t.State.BranchExterior=t.State.BranchExterior.MoveH(r)}catch(t){}return!0};try{for(var l=i(a),u=l.next();!u.done;u=l.next()){u.value.IterateChildFirst(s)}}catch(t){n={error:t}}finally{try{u&&!u.done&&(o=l.return)&&o.call(l)}finally{if(n)throw n.error}}e.Boundary.ReloadFromBranch(e.BranchRoot),e.BranchRoot.State.BranchExterior=e.Boundary.BoundingRect},t.MoveOneChild=function(t,e,r){e.IterateChildFirst((function(t){return t.State.IsHidden||(t.State.TopLeft=t.State.TopLeft.MoveH(r),t.State.BranchExterior=t.State.BranchExterior.MoveH(r)),!0}))},t.MoveBranch=function(t,e,r){this.MoveOneChild(t,e.BranchRoot,r),e.Boundary.ReloadFromBranch(e.BranchRoot),e.BranchRoot.State.BranchExterior=e.Boundary.BoundingRect},t.AlignHorizontalCenters=function(t,e,r){var n,o,a,s,l=Number.MIN_VALUE;try{for(var u=i(r),h=u.next();!h.done;h=u.next()){var c=(m=h.value).State.CenterH;c>l&&(l=c)}}catch(t){n={error:t}}finally{try{h&&!h.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}var f=Number.MAX_VALUE,S=Number.MIN_VALUE;try{for(var p=i(r),g=p.next();!g.done;g=p.next()){var m,y=(m=g.value).State.CenterH;if(y!==l){var b=l-y;this.MoveOneChild(t,m,b)}f=Math.min(f,m.State.BranchExterior.Left),S=Math.max(S,m.State.BranchExterior.Right)}}catch(t){a={error:t}}finally{try{g&&!g.done&&(s=p.return)&&s.call(p)}finally{if(a)throw a.error}}return e.Boundary.ReloadFromBranch(e.BranchRoot),new d.default(f,S)},t.CopyExteriorFrom=function(t,e){t.TopLeft=e.TopLeft,t.Size=e.Size,t.BranchExterior=e.BranchExterior,t.SiblingsRowV=e.SiblingsRowV},t.IsMinValue=function(t){return t<=Number.MIN_VALUE+Number.EPSILON},t.IsMaxValue=function(t){return t>=Number.MAX_VALUE-Number.EPSILON},t.IsZero=function(t){return t<=Number.EPSILON&&t>=-Number.EPSILON},t.IsEqual=function(t,e){return Math.abs(t-e)<=Number.EPSILON},t.MoveTo=function(t,e,r){t.TopLeft=new h.default(e,r)},t.AdjustSpacer=function(t,e,r,n,o){t.TopLeft=new h.default(e,r),t.Size=new c.default(n,o),t.BranchExterior=new s.default(e,r,n,o)},t}();e.default=S},"./dist/core/LayoutLevel.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t,e){this.BranchRoot=t,this.Boundary=e};e.default=n},"./dist/core/LayoutState.js":function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(r("./dist/core/Operation.js")),i=n(r("./dist/core/LayoutStateOperationChangedEventArgs.js")),a=n(r("./dist/core/Boundary.js")),s=n(r("./dist/core/LayoutLevel.js")),l=n(r("./dist/core/BoundaryChangedEventArgs.js")),u=n(r("./dist/core/Rect.js")),h=n(r("./dist/core/LayoutAlgorithm.js")),d=r("./dist/core/Utils.js"),c=function(){function t(t){this._currentOperation=o.default.Idle,this._layoutStack=[],this._pooledBoundaries=[],this.BoxSizeFunc=null,this.LayoutOptimizerFunc=null,this.BoundaryChanged=null,this.OperationChanged=null,this.Diagram=t}return Object.defineProperty(t.prototype,"CurrentOperation",{get:function(){return this._currentOperation},set:function(t){this._currentOperation=t,this.OperationChanged&&this.OperationChanged(this,new i.default(this))},enumerable:!1,configurable:!0}),t.prototype.AttachVisualTree=function(t){for(;this._pooledBoundaries.length<t.Depth;)this._pooledBoundaries.push(new a.default)},t.prototype.PushLayoutLevel=function(t){0==this._pooledBoundaries.length&&this._pooledBoundaries.push(new a.default);var e=this._pooledBoundaries.pop();if(null==e)throw Error("Boundary is null");switch(this.CurrentOperation){case o.default.VerticalLayout:e.Prepare(t);break;case o.default.HorizontalLayout:e.PrepareForHorizontalLayout(t);break;default:throw new Error("This operation can only be invoked when performing vertical or horizontal layouts")}if(null==e)throw Error("Boundary cannot be null");var r=new s.default(t,e);return this._layoutStack.push(r),this.BoundaryChanged&&this.BoundaryChanged(this,new l.default(e,r,this)),r},t.prototype.MergeSpacer=function(t){if(this.CurrentOperation!=o.default.HorizontalLayout)throw new Error("Spacers can only be merged during horizontal layout");if(0==this._layoutStack.length)throw new Error("Cannot merge spacers at top nesting level");var e=d.peek(this._layoutStack);if(null==e)throw Error("Level is null");e.Boundary.MergeFromNode(t),this.BoundaryChanged&&this.BoundaryChanged(this,new l.default(e.Boundary,e,this))},t.prototype.PopLayoutLevel=function(){var t=this._layoutStack.pop();if(null==t)throw Error("innerLevel is null");if(this.BoundaryChanged&&this.BoundaryChanged(this,new l.default(t.Boundary,t,this)),this._layoutStack.length>0){var e=d.peek(this._layoutStack);if(null==e)throw Error("higherLevel is null");switch(this.CurrentOperation){case o.default.VerticalLayout:e.Boundary.VerticalMergeFrom(t.Boundary),e.BranchRoot.State.BranchExterior=e.Boundary.BoundingRect;break;case o.default.HorizontalLayout:if(e.BranchRoot.AssistantsRoot!=t.BranchRoot){var r=e.BranchRoot.State.RequireLayoutStrategy,n=e.Boundary.ComputeOverlap(t.Boundary,r.SiblingSpacing,this.Diagram.LayoutSettings.BranchSpacing);n>0&&(h.default.MoveBranch(this,t,n),this.BoundaryChanged&&this.BoundaryChanged(this,new l.default(t.Boundary,t,this)))}e.Boundary.MergeFrom(t.Boundary),e.BranchRoot.State.BranchExterior=new u.default(e.Boundary.BoundingRect.Left,e.BranchRoot.State.BranchExterior.Top,e.Boundary.BoundingRect.Size.Width,e.BranchRoot.State.BranchExterior.Size.Height);break;default:throw new Error("This operation can only be invoked when performing vertical or horizontal layouts")}this.BoundaryChanged&&this.BoundaryChanged(this,new l.default(e.Boundary,e,this))}this._pooledBoundaries.push(t.Boundary)},t}();e.default=c},"./dist/core/LayoutStateOperationChangedEventArgs.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){this.State=t,this.CurrentOperation=t.CurrentOperation};e.default=n},"./dist/core/LayoutStrategyBase.js":function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(r("./dist/core/BranchParentAlignment.js")),i=function(){function t(){this.ParentAlignment=o.default.InvalidValue,this.ParentChildSpacing=20,this.ParentConnectorShield=50,this.SiblingSpacing=20,this.ChildConnectorHookLength=5}return Object.defineProperty(t.prototype,"SupportsAssistants",{get:function(){return this.GetSupportsAssistants()},enumerable:!1,configurable:!0}),t}();e.default=i},"./dist/core/LinearLayoutStrategy.js":function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=i(r("./dist/core/Point.js")),s=i(r("./dist/core/LayoutStrategyBase.js")),l=i(r("./dist/core/Dimensions.js")),u=i(r("./dist/core/LayoutAlgorithm.js")),h=i(r("./dist/core/Box.js")),d=i(r("./dist/core/BranchParentAlignment.js")),c=i(r("./dist/core/Rect.js")),f=i(r("./dist/core/Edge.js")),S=i(r("./dist/core/Connector.js")),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.GetSupportsAssistants=function(){return!0},e}return o(e,t),e.prototype.PreProcessThisNode=function(t,e){if(e.ChildCount>0&&(e.State.NumberOfSiblings=e.Element.IsCollapsed?0:e.ChildCount,!e.Element.IsCollapsed)){var r=h.default.Special(h.default.None,e.Element.Id,!1);e.AddRegularChildBox(r);var n=h.default.Special(h.default.None,e.Element.Id,!1);e.AddRegularChildBox(n)}},e.prototype.ApplyVerticalLayout=function(t,e){var r=e.BranchRoot;if(0==r.Level&&(r.State.SiblingsRowV=new l.default(r.State.Top,r.State.Bottom)),null!=r.AssistantsRoot&&(u.default.CopyExteriorFrom(r.AssistantsRoot.State,r.State),u.default.VerticalLayout(t,r.AssistantsRoot)),0!=r.State.NumberOfSiblings){var n,o=l.default.MinMax();if(null==r.AssistantsRoot){if(null==r.State.SiblingsRowV)throw Error("SiblingsRowV is null");n=r.State.SiblingsRowV.To+this.ParentChildSpacing}else n=r.State.BranchExterior.Bottom+this.ParentChildSpacing;for(var i=0;i<r.State.NumberOfSiblings;i++){var a=(s=r.Children[i]).State;if(u.default.MoveTo(s.State,0,n),null==s.State.Size)throw Error("Size is null");if(s.State.BranchExterior=c.default.from(s.State.Size,s.State.TopLeft),null==a.Size)throw Error("Size is null");o=l.default.add(o,new l.default(n,n+a.Size.Height))}o=new l.default(o.From,o.To);for(i=0;i<r.State.NumberOfSiblings;i++){var s;(s=r.Children[i]).State.SiblingsRowV=o,u.default.VerticalLayout(t,s)}}},e.prototype.ApplyHorizontalLayout=function(t,e){var r=e.BranchRoot;null!=r.AssistantsRoot&&u.default.HorizontalLayout(t,r.AssistantsRoot);for(var n=0;n<r.State.NumberOfSiblings;n++){var o=r.Children[n];u.default.HorizontalLayout(t,o)}if(r.Level>0&&r.ChildCount>0){var i=r.State,a=r.Children[0].State.CenterH,s=r.Children[r.State.NumberOfSiblings-1].State.CenterH,l=1==r.State.NumberOfSiblings||this.ParentAlignment==d.default.Center?a+(s-a)/2:this.ParentAlignment==d.default.Left?a+this.ChildConnectorHookLength:s-this.ChildConnectorHookLength,h=i.CenterH,c=h-l;u.default.MoveChildrenOnly(t,e,c);var f=r.Children[r.State.NumberOfSiblings];if(null==r.Children[0].State.SiblingsRowV)throw Error("SiblingsRowV is null");u.default.AdjustSpacer(f.State,h-this.ParentConnectorShield/2,i.Bottom,this.ParentConnectorShield,r.Children[0].State.SiblingsRowV.From-i.Bottom),t.MergeSpacer(f);var S=r.Children[0].State,p=r.Children[r.State.NumberOfSiblings+1];if(null==S.SiblingsRowV)throw Error("SiblingsRowV is null");u.default.AdjustSpacer(p.State,S.Left,S.SiblingsRowV.From-this.ParentChildSpacing,r.Children[r.State.NumberOfSiblings-1].State.Right-S.Left,this.ParentChildSpacing),t.MergeSpacer(p)}},e.prototype.RouteConnectors=function(t,e){var r=e.State.NumberOfSiblings,n=0==r?0:1==r?1:2+r;if(0!=n){var o=[],i=e.State,s=i.CenterH;if(null==e.Children)throw new Error("State is present, but children not set");if(1==n)o[0]=new f.default(new a.default(s,i.Bottom),new a.default(s,e.Children[0].State.Top));else{if(null==e.Children[0].State.SiblingsRowV)throw Error("SiblingsRowV is null");var l=e.Children[0].State.SiblingsRowV.From-i.Bottom;o[0]=new f.default(new a.default(s,i.Bottom),new a.default(s,i.Bottom+l-this.ChildConnectorHookLength));for(var u=0;u<r;u++){var h=e.Children[u].State,d=h.CenterH;o[1+u]=new f.default(new a.default(d,h.Top),new a.default(d,h.Top-this.ChildConnectorHookLength))}o[n-1]=new f.default(new a.default(o[1].To.X,o[1].To.Y),new a.default(o[n-2].To.X,o[1].To.Y))}e.State.Connector=new S.default(o)}else e.State.Connector=null},e}(s.default);e.default=p},"./dist/core/MultiLineFishboneLayoutStrategy.js":function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=i(r("./dist/core/LinearLayoutStrategy.js")),s=i(r("./dist/core/LayoutStrategyBase.js")),l=i(r("./dist/core/Node.js")),u=i(r("./dist/core/Box.js")),h=i(r("./dist/core/Dimensions.js")),d=i(r("./dist/core/LayoutAlgorithm.js")),c=i(r("./dist/core/BranchParentAlignment.js")),f=i(r("./dist/core/Edge.js")),S=i(r("./dist/core/Point.js")),p=i(r("./dist/core/Connector.js")),g=i(r("./dist/core/Rect.js")),m=function(){function t(t,e){this.Group=0,this.FromIndex=0,this.Count=0,this.MaxOnLeft=0,this._numberOfSiblings=t,this._numberOfGroups=e}return t.prototype.CountInGroup=function(){for(var t=2*this._numberOfGroups,e=0,r=2*this.Group+2,n=0;;){var o=n>=this._numberOfSiblings-t?this._numberOfSiblings-n:t;if(!(o>=r)){o>=--r&&e++;break}e+=2,n+=t}return e},t.prototype.NextGroup=function(){return this.FromIndex=this.FromIndex+this.Count,this.FromIndex>0&&this.Group++,this.Count=this.CountInGroup(),this.MaxOnLeft=Math.floor(this.Count/2)+this.Count%2,0!=this.Count},t}(),y=function(t){function e(e){return t.call(this,e)||this}return o(e,t),e.prototype.Prepare=function(t){null==this.Children?this.Children=[]:this.Children.length=0},e.prototype.AddChildView=function(t){this.Children.push(t)},e}(l.default),b=function(t){function e(e){var r=t.call(this)||this;r.GetSupportsAssistants=function(){return!1},r.Iterator=new m(e.State.NumberOfSiblings,e.State.NumberOfSiblingColumns),r.RealRoot=e,r.SpecialRoot=new y(u.default.Special(u.default.None,e.Element.Id,!0)),r.SpecialRoot.Level=r.RealRoot.Level,r.SpecialRoot.ParentNode=r.RealRoot,r.SpecialRoot.State.EffectiveLayoutStrategy=r;var n=e.State.RequireLayoutStrategy;return r.SiblingSpacing=n.SiblingSpacing,r.ParentConnectorShield=n.ParentConnectorShield,r.ParentChildSpacing=n.ParentChildSpacing,r.ParentAlignment=n.ParentAlignment,r.ChildConnectorHookLength=n.ChildConnectorHookLength,r}return o(e,t),e.prototype.NextGroup=function(){if(!this.Iterator.NextGroup())return!1;this.SpecialRoot.State.NumberOfSiblings=this.Iterator.Count,this.SpecialRoot.Prepare(2*this.RealRoot.State.NumberOfSiblingRows);for(var t=0;t<this.Iterator.Count;t++)this.SpecialRoot.AddChildView(this.RealRoot.Children[this.Iterator.FromIndex+t]);var e=this.RealRoot.Children[this.RealRoot.State.NumberOfSiblings+1+this.Iterator.Group];return this.SpecialRoot.AddChildView(e),d.default.CopyExteriorFrom(this.SpecialRoot.State,this.RealRoot.State),!0},e.prototype.PreProcessThisNode=function(t,e){throw new Error("NotSupportedException")},e.prototype.ApplyVerticalLayout=function(t,e){var r,n;if(null==this.SpecialRoot.State.SiblingsRowV)throw Error("SiblingsRowV is null");for(var o=null!==(n=null===(r=this.RealRoot.AssistantsRoot)||void 0===r?void 0:r.State.BranchExterior.Bottom)&&void 0!==n?n:this.SpecialRoot.State.SiblingsRowV.To,i=0;i<this.Iterator.MaxOnLeft;i++){var a=0==i?this.ParentChildSpacing:this.SiblingSpacing,s=this.SpecialRoot.Children[i],l=s.State;d.default.MoveTo(l,l.Left,o+a);var u=new h.default(l.Top,l.Bottom),c=i+this.Iterator.MaxOnLeft;if(null==l.Size)throw Error("Size is null");if(c<this.Iterator.Count){var f=this.SpecialRoot.Children[c],S=f.State;if(d.default.MoveTo(S,S.Left,o+a),null==S.Size)throw Error("Size is null");S.Bottom>l.Bottom?d.default.MoveTo(l,l.Left,S.CenterV-l.Size.Height/2):S.Bottom<l.Bottom&&d.default.MoveTo(S,S.Left,l.CenterV-S.Size.Height/2),S.BranchExterior=g.default.from(S.Size,S.TopLeft),u=h.default.add(u,new h.default(S.Top,S.Bottom)),S.SiblingsRowV=u,d.default.VerticalLayout(t,f),o=S.BranchExterior.Bottom}l.BranchExterior=g.default.from(l.Size,l.TopLeft),l.SiblingsRowV=u,d.default.VerticalLayout(t,s),o=Math.max(o,l.BranchExterior.Bottom)}},e.prototype.ApplyHorizontalLayout=function(t,e){if(e.BranchRoot!=this.SpecialRoot)throw new Error("InvalidOperationException: Wrong root node received");for(var r=!0,n=0,o=0;o<this.Iterator.Count;o++){var i=this.SpecialRoot.Children[o];if(d.default.HorizontalLayout(t,i),++n==this.Iterator.MaxOnLeft&&r){d.default.AlignHorizontalCenters(t,e,this.EnumerateSiblings(0,this.Iterator.MaxOnLeft)),r=!1,n=0;for(var a=Number.MIN_VALUE,s=0;s<o;s++)a=Math.max(a,this.SpecialRoot.Children[s].State.BranchExterior.Right);a=Math.max(a,i.State.Right);var l=this.SpecialRoot.Children[this.SpecialRoot.State.NumberOfSiblings];if(null==this.SpecialRoot.Children[0].State.SiblingsRowV)throw Error("SiblingsRowV is null");if(null==i.State.SiblingsRowV)throw Error("SiblingsRowV is null");d.default.AdjustSpacer(l.State,a,this.SpecialRoot.Children[0].State.SiblingsRowV.From,this.SiblingSpacing,i.State.SiblingsRowV.To-this.SpecialRoot.Children[0].State.SiblingsRowV.From),e.Boundary.MergeFromNode(l)}}d.default.AlignHorizontalCenters(t,e,this.EnumerateSiblings(this.Iterator.MaxOnLeft,this.Iterator.Count))},e.prototype.EnumerateSiblings=function(t,e){for(var r=[],n=t;n<e;n++)r.push(this.SpecialRoot.Children[n]);return r},e.prototype.RouteConnectors=function(t,e){throw new Error},e}(s.default),C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.MaxGroups=4,e.GetSupportsAssistants=function(){return!0},e}return o(e,t),e.prototype.PreProcessThisNode=function(e,r){if(this.MaxGroups<=0)throw new Error("MaxGroups must be a positive value");if(r.ChildCount<=2*this.MaxGroups)t.prototype.PreProcessThisNode.call(this,e,r);else if(r.State.NumberOfSiblings=r.ChildCount,r.State.NumberOfSiblings>0){r.State.NumberOfSiblingColumns=this.MaxGroups,r.State.NumberOfSiblingRows=Math.floor(r.State.NumberOfSiblings/(2*this.MaxGroups)),r.State.NumberOfSiblings%(2*this.MaxGroups)!=0&&r.State.NumberOfSiblingRows++;var n=u.default.Special(u.default.None,r.Element.Id,!1);r.AddRegularChildBox(n);for(var o=0;o<r.State.NumberOfSiblingColumns;o++){var i=u.default.Special(u.default.None,r.Element.Id,!1);r.AddRegularChildBox(i)}if(r.State.NumberOfSiblingColumns>1){var a=u.default.Special(u.default.None,r.Element.Id,!1);r.AddRegularChildBox(a)}}},e.prototype.ApplyVerticalLayout=function(e,r){var n=r.BranchRoot;if(n.State.NumberOfSiblings<=2*this.MaxGroups)t.prototype.ApplyVerticalLayout.call(this,e,r);else{0==n.Level&&(n.State.SiblingsRowV=new h.default(n.State.Top,n.State.Bottom)),null!=n.AssistantsRoot&&(d.default.CopyExteriorFrom(n.AssistantsRoot.State,n.State),d.default.VerticalLayout(e,n.AssistantsRoot));for(var o=new b(n);o.NextGroup();)d.default.VerticalLayout(e,o.SpecialRoot)}},e.prototype.ApplyHorizontalLayout=function(e,r){var n=r.BranchRoot;if(n.State.NumberOfSiblings<=2*this.MaxGroups)t.prototype.ApplyHorizontalLayout.call(this,e,r);else{0==n.Level&&(n.State.SiblingsRowV=new h.default(n.State.Top,n.State.Bottom)),null!=n.AssistantsRoot&&d.default.HorizontalLayout(e,n.AssistantsRoot);for(var o=new b(n);o.NextGroup();)d.default.HorizontalLayout(e,o.SpecialRoot);var i=n.State;if(n.Level>0){var a=0;if(n.State.NumberOfSiblingColumns>1){var s=n.Children[n.State.NumberOfSiblings+1].State.CenterH,l=n.Children[n.State.NumberOfSiblings+n.State.NumberOfSiblingColumns].State.CenterH,u=1==n.State.NumberOfSiblings||this.ParentAlignment==c.default.Center?s+(l-s)/2:this.ParentAlignment==c.default.Left?s+this.ChildConnectorHookLength:l-this.ChildConnectorHookLength;a=i.CenterH-u}else{var f=n.Children[1+n.State.NumberOfSiblings].State.CenterH;a=(u=i.CenterH)-f}d.default.MoveChildrenOnly(e,r,a)}if(n.Level>0){if(null==n.Children[0].State.SiblingsRowV)throw Error("SiblingsRowV is null");var S=n.State.NumberOfSiblings,p=n.Children[S];if(d.default.AdjustSpacer(p.State,i.CenterH-this.ParentConnectorShield/2,i.Bottom,this.ParentConnectorShield,n.Children[0].State.SiblingsRowV.From-i.Bottom),e.MergeSpacer(p),S++,S+=n.State.NumberOfSiblingColumns,n.State.NumberOfSiblingColumns>1){var g=n.Children[S],m=n.Children[n.State.NumberOfSiblings+1].State.TopLeft,y=n.Children[S-1].State.Right;d.default.AdjustSpacer(g.State,m.X,m.Y-this.ParentChildSpacing,y-m.X,this.ParentChildSpacing),e.MergeSpacer(g)}}}},e.prototype.RouteConnectors=function(e,r){if(r.State.NumberOfSiblings<=2*this.MaxGroups)t.prototype.RouteConnectors.call(this,e,r);else{r.State.NumberOfSiblings,r.State.NumberOfSiblingColumns;r.State.NumberOfSiblingColumns>1&&0;var n=[],o=r.State,i=o.CenterH,a=0;if(null==r.Children[0].State.SiblingsRowV)throw Error("SiblingsRowV is null");var s=r.Children[0].State.SiblingsRowV.From-o.Bottom;n[a++]=new f.default(new S.default(i,o.Bottom),new S.default(i,o.Bottom+s-this.ChildConnectorHookLength));for(var l=new m(r.State.NumberOfSiblings,r.State.NumberOfSiblingColumns);l.NextGroup();)for(var u=r.Children[1+r.State.NumberOfSiblings+l.Group].State,h=u.CenterH,d=!0,c=0,g=l.FromIndex;g<l.FromIndex+l.Count;g++){var y=d?r.Children[g].State.Right:r.Children[g].State.Left,b=r.Children[g].State.CenterV;n[a++]=new f.default(new S.default(h,b),new S.default(y,b)),++c==l.MaxOnLeft&&(c=0,d&&(n[1+r.State.NumberOfSiblings+l.Group]=new f.default(new S.default(u.CenterH,u.Top-this.ChildConnectorHookLength),new S.default(u.CenterH,r.Children[g].State.CenterV))),d=!d)}if(a+=r.State.NumberOfSiblingColumns,r.State.NumberOfSiblingColumns>1){var C=r.Children[1+r.State.NumberOfSiblings].State,v=r.Children[1+r.State.NumberOfSiblings+r.State.NumberOfSiblingColumns-1].State;n[a]=new f.default(new S.default(C.CenterH,C.Top-this.ChildConnectorHookLength),new S.default(v.CenterH,v.Top-this.ChildConnectorHookLength))}r.State.Connector=new p.default(n)}},e}(a.default);e.default=C},"./dist/core/MultiLineHangerLayoutStrategy.js":function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=a(r("./dist/core/LinearLayoutStrategy.js")),l=a(r("./dist/core/Box.js")),u=a(r("./dist/core/Dimensions.js")),h=a(r("./dist/core/LayoutAlgorithm.js")),d=a(r("./dist/core/Edge.js")),c=a(r("./dist/core/Point.js")),f=a(r("./dist/core/Connector.js")),S=a(r("./dist/core/Rect.js")),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.MaxSiblingsPerRow=4,e.GetSupportsAssistants=function(){return!0},e}return o(e,t),e.prototype.PreProcessThisNode=function(e,r){if(this.MaxSiblingsPerRow<=0||this.MaxSiblingsPerRow%2!=0)throw new Error("MaxSiblingsPerRow must be a positive even value");if(r.ChildCount<=this.MaxSiblingsPerRow)t.prototype.PreProcessThisNode.call(this,e,r);else if(r.State.NumberOfSiblings=r.ChildCount,r.State.NumberOfSiblings>0){var n=r.ChildCount%this.MaxSiblingsPerRow;r.State.NumberOfSiblingColumns=1+this.MaxSiblingsPerRow,r.State.NumberOfSiblingRows=Math.floor(r.ChildCount/this.MaxSiblingsPerRow),0!=n&&r.State.NumberOfSiblingRows++,r.State.NumberOfSiblings=r.ChildCount+r.State.NumberOfSiblingRows,n>0&&n<=Math.floor(this.MaxSiblingsPerRow/2)&&r.State.NumberOfSiblings--;for(var o=Math.floor(this.MaxSiblingsPerRow/2);o<r.State.NumberOfSiblings;){var i=l.default.Special(l.default.None,r.Element.Id,!1);r.InsertRegularChildBoxByIndex(o,i),o+=r.State.NumberOfSiblingColumns}var a=l.default.Special(l.default.None,r.Element.Id,!1);r.AddRegularChildBox(a);for(var s=0;s<r.State.NumberOfSiblingRows;s++){var u=l.default.Special(l.default.None,r.Element.Id,!1);r.AddRegularChildBox(u)}}},e.prototype.ApplyVerticalLayout=function(e,r){var n=r.BranchRoot;if(n.State.NumberOfSiblings<=this.MaxSiblingsPerRow)t.prototype.ApplyVerticalLayout.call(this,e,r);else{0==n.Level&&(n.State.SiblingsRowV=new u.default(n.State.Top,n.State.Bottom)),null!=n.AssistantsRoot&&(h.default.CopyExteriorFrom(n.AssistantsRoot.State,n.State),h.default.VerticalLayout(e,n.AssistantsRoot));for(var o=new u.default(n.State.SiblingsRowV.From,null==n.AssistantsRoot?n.State.SiblingsRowV.To:n.State.BranchExterior.Bottom),i=0;i<n.State.NumberOfSiblingRows;i++){for(var a=u.default.MinMax(),s=0==i?this.ParentChildSpacing:this.SiblingSpacing,l=i*n.State.NumberOfSiblingColumns,d=Math.min(l+n.State.NumberOfSiblingColumns,n.State.NumberOfSiblings),c=l;c<d;c++){if(!(m=n.Children[c]).Element.IsSpecial){var f=m.State,p=o.To+s;h.default.MoveTo(m.State,f.Left,p),m.State.BranchExterior=S.default.from(m.State.Size,m.State.TopLeft),a=u.default.add(a,new u.default(p,p+f.Size.Height))}}a=new u.default(a.From,a.To);var g=Number.MIN_VALUE;for(c=l;c<d;c++){var m;(m=n.Children[c]).State.SiblingsRowV=a,h.default.VerticalLayout(e,m),g=Math.max(g,m.State.BranchExterior.Bottom)}o=new u.default(a.From,Math.max(g,a.To));var y=l+Math.floor(n.State.NumberOfSiblingColumns/2);if(y<n.State.NumberOfSiblings){var b=i==n.State.NumberOfSiblingRows-1?n.Children[y-1].State.SiblingsRowV.To:o.To,C=n.Children[y].State;h.default.AdjustSpacer(C,0,o.From,this.ParentConnectorShield,b-o.From)}}}},e.prototype.ApplyHorizontalLayout=function(e,r){var n=r.BranchRoot;if(n.State.NumberOfSiblings<=this.MaxSiblingsPerRow)t.prototype.ApplyHorizontalLayout.call(this,e,r);else{null!=n.AssistantsRoot&&h.default.HorizontalLayout(e,n.AssistantsRoot);for(var o=0;o<n.State.NumberOfSiblingColumns;o++){for(var i=0;i<n.State.NumberOfSiblingRows;i++){var a=i*n.State.NumberOfSiblingColumns+o;if(a>=n.State.NumberOfSiblings)break;var s=n.Children[a];h.default.HorizontalLayout(e,s)}h.default.AlignHorizontalCenters(e,r,this.EnumerateColumn(n,o))}var l=n.State,u=n.Children[Math.floor(n.State.NumberOfSiblingColumns/2)].State.CenterH,d=l.CenterH-u;h.default.MoveChildrenOnly(e,r,d);var c=n.Children[n.State.NumberOfSiblings];h.default.AdjustSpacer(c.State,l.CenterH-this.ParentConnectorShield/2,l.Bottom,this.ParentConnectorShield,n.Children[0].State.SiblingsRowV.From-l.Bottom),e.MergeSpacer(c);for(var f=this.ParentChildSpacing,S=0;S<n.State.NumberOfSiblings;S+=n.State.NumberOfSiblingColumns){var p=n.Children[S].State,g=n.Children[Math.min(S+n.State.NumberOfSiblingColumns-1,n.State.NumberOfSiblings-1)].State,m=n.Children[1+n.State.NumberOfSiblings+Math.floor(S/n.State.NumberOfSiblingColumns)],y=g.Right>=c.State.Right?g.Right-p.Left:c.State.Right-p.Left;h.default.AdjustSpacer(m.State,p.Left,p.SiblingsRowV.From-f,y,f),e.MergeSpacer(m),f=this.SiblingSpacing}}},e.prototype.EnumerateColumn=function(t,e){for(var r=[],n=0;n<t.State.NumberOfSiblingRows;n++){var o=n*t.State.NumberOfSiblingColumns+e;if(o>=t.State.NumberOfSiblings)break;r.push(t.Children[o])}return r},e.prototype.RouteConnectors=function(e,r){var n,o;if(r.State.NumberOfSiblings<=this.MaxSiblingsPerRow)t.prototype.RouteConnectors.call(this,e,r);else{var a=1+r.State.NumberOfSiblingRows;try{for(var s=i(r.Children),l=s.next();!l.done;l=s.next()){(y=l.value).Element.IsSpecial||a++}}catch(t){n={error:t}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}var u=[],h=r.State,S=h.CenterH,p=r.Children[r.State.NumberOfSiblings-1].State.SiblingsRowV.From-this.ChildConnectorHookLength-h.Bottom;u[0]=new d.default(new c.default(S,h.Bottom),new c.default(S,h.Bottom+p));for(var g=1,m=0;m<r.State.NumberOfSiblings;m++){var y;if(!(y=r.Children[m]).Element.IsSpecial){var b=y.State,C=b.CenterH;u[g++]=new d.default(new c.default(C,b.Top),new c.default(C,b.Top-this.ChildConnectorHookLength))}}for(var v=a-r.State.NumberOfSiblingRows-1,w=1;w<a-r.State.NumberOfSiblingRows;w+=this.MaxSiblingsPerRow){var L=u[w],B=u[Math.min(w+this.MaxSiblingsPerRow-1,v)];B.From.X<u[0].From.X?u[g++]=new d.default(new c.default(L.To.X,L.To.Y),new c.default(u[0].To.X,L.To.Y)):u[g++]=new d.default(new c.default(L.To.X,L.To.Y),new c.default(B.To.X,L.To.Y))}r.State.Connector=new f.default(u)}},e}(s.default);e.default=p},"./dist/core/Node.js":function(t,e,r){"use strict";var n=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=o(r("./dist/core/Box.js")),a=o(r("./dist/core/NodeLayoutInfo.js")),s=function(){function t(t){this.Level=0,this.Children=[],this.AssistantsRoot=null,this.ParentNode=null,this.Element=t,this.State=new a.default}return Object.defineProperty(t.prototype,"ChildCount",{get:function(){var t;return(null===(t=this.Children)||void 0===t?void 0:t.length)||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"IsAssistantRoot",{get:function(){var t;return(null===(t=this.ParentNode)||void 0===t?void 0:t.AssistantsRoot)==this},enumerable:!1,configurable:!0}),t.prototype.AddAssistantChild=function(e){return null==this.AssistantsRoot&&(this.AssistantsRoot=new t(i.default.Special(i.default.None,this.Element.Id,!0)),this.AssistantsRoot.ParentNode=this,this.AssistantsRoot.Level=this.AssistantsRoot.Level+1),this.AssistantsRoot.AddRegularChild(e),this},t.prototype.AddRegularChild=function(t){return this.InsertRegularChild(this.ChildCount,t)},t.prototype.AddRegularChildBox=function(t){return this.InsertRegularChildBoxByIndex(this.ChildCount,t)},t.prototype.InsertRegularChildBox=function(t){return this.InsertRegularChildBoxByIndex(this.ChildCount,t)},t.prototype.InsertRegularChildBoxByIndex=function(e,r){return this.InsertRegularChild(e,new t(r))},t.prototype.InsertRegularChild=function(t,e){return null==this.Children&&(this.Children=[]),this.Children.splice(t,0,e),e.ParentNode=this,e.Level=this.Level+1,this},t.prototype.IterateChildFirst=function(t){var e,r;if(null!=this.AssistantsRoot&&!this.AssistantsRoot.IterateChildFirst(t))return!1;if(null!=this.Children)try{for(var o=n(this.Children),i=o.next();!i.done;i=o.next()){if(!i.value.IterateChildFirst(t))return!1}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return t(this)},t.prototype.IterateParentFirst=function(t,e){var r,o,i;if(!t(this))return e&&e(this),!1;if(null===(i=this.AssistantsRoot)||void 0===i||i.IterateParentFirst(t,e),null!=this.Children)try{for(var a=n(this.Children),s=a.next();!s.done;s=a.next()){s.value.IterateParentFirst(t,e)}}catch(t){r={error:t}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}return e&&e(this),!0},t.prototype.SuppressAssistants=function(){var t,e;if(null!=this.AssistantsRoot){try{for(var r=n(this.AssistantsRoot.Children),o=r.next();!o.done;o=r.next()){var i=o.value;this.AddRegularChild(i)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.AssistantsRoot=null}},t}();e.default=s},"./dist/core/NodeLayoutInfo.js":function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(r("./dist/core/Size.js")),i=n(r("./dist/core/Point.js")),a=n(r("./dist/core/Dimensions.js")),s=n(r("./dist/core/Rect.js")),l=function(){function t(){this._effectiveLayoutStrategy=null,this.IsHidden=!1,this.Connector=null,this.NumberOfSiblings=0,this.NumberOfSiblingRows=0,this.NumberOfSiblingColumns=0,this.Size=new o.default(0,0),this.TopLeft=new i.default(0,0),this.BranchExterior=new s.default(0,0,0,0),this.SiblingsRowV=new a.default(0,0)}return Object.defineProperty(t.prototype,"EffectiveLayoutStrategy",{set:function(t){this._effectiveLayoutStrategy=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RequireLayoutStrategy",{get:function(){if(null==this._effectiveLayoutStrategy)throw new Error("EffectiveLayoutStrategy is not set");return this._effectiveLayoutStrategy},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Left",{get:function(){if(null==this.TopLeft)throw Error("TopLeft is null");return this.TopLeft.X},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Right",{get:function(){if(null==this.TopLeft)throw Error("TopLeft is null");if(null==this.Size)throw Error("Size is null");return this.TopLeft.X+this.Size.Width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Top",{get:function(){if(null==this.TopLeft)throw Error("TopLeft is null");if(null==this.Size)throw Error("Size is null");return this.TopLeft.Y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Bottom",{get:function(){if(null==this.TopLeft)throw Error("TopLeft is null");if(null==this.Size)throw Error("Size is null");return this.TopLeft.Y+this.Size.Height},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"CenterH",{get:function(){if(null==this.TopLeft)throw Error("TopLeft is null");if(null==this.Size)throw Error("Size is null");return this.TopLeft.X+this.Size.Width/2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"CenterV",{get:function(){if(null==this.TopLeft)throw Error("TopLeft is null");if(null==this.Size)throw Error("Size is null");return this.TopLeft.Y+this.Size.Height/2},enumerable:!1,configurable:!0}),t}();e.default=l},"./dist/core/Operation.js":function(t,e,r){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.Idle=0]="Idle",t[t.Preparing=1]="Preparing",t[t.PreprocessVisualTree=2]="PreprocessVisualTree",t[t.VerticalLayout=3]="VerticalLayout",t[t.HorizontalLayout=4]="HorizontalLayout",t[t.ConnectorsLayout=5]="ConnectorsLayout",t[t.Completed=6]="Completed"}(n||(n={})),e.default=n},"./dist/core/Point.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){this.X=t,this.Y=e}return t.prototype.MoveH=function(e){return new t(this.X+e,this.Y)},t}();e.default=n},"./dist/core/Rect.js":function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(r("./dist/core/Point.js")),i=n(r("./dist/core/Size.js")),a=function(){function t(t,e,r,n){if(r<0)throw new Error("Width out of range");if(n<0)throw new Error("Height out of range");this.TopLeft=new o.default(t,e),this.Size=new i.default(r,n)}return Object.defineProperty(t.prototype,"BottomRight",{get:function(){return new o.default(this.TopLeft.X+this.Size.Width,this.TopLeft.Y+this.Size.Height)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Left",{get:function(){return this.TopLeft.X},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Right",{get:function(){return this.TopLeft.X+this.Size.Width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"CenterH",{get:function(){return this.TopLeft.X+this.Size.Width/2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"CenterV",{get:function(){return this.TopLeft.Y+this.Size.Height/2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Top",{get:function(){return this.TopLeft.Y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Bottom",{get:function(){return this.TopLeft.Y+this.Size.Height},enumerable:!1,configurable:!0}),t.from=function(e,r){return void 0===r&&(r=new o.default(0,0)),new t(r.X,r.Y,e.Width,e.Height)},t.add=function(e,r){var n=Math.min(e.Left,r.Left),o=Math.min(e.Top,r.Top);return new t(n,o,Math.max(e.Right,r.Right)-n,Math.max(e.Bottom,r.Bottom)-o)},t.prototype.MoveH=function(e){return t.from(this.Size,new o.default(this.Left+e,this.Top))},t}();e.default=a},"./dist/core/SingleColumnLayoutStrategy.js":function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=i(r("./dist/core/LayoutStrategyBase.js")),s=i(r("./dist/core/Box.js")),l=i(r("./dist/core/Dimensions.js")),u=i(r("./dist/core/LayoutAlgorithm.js")),h=i(r("./dist/core/BranchParentAlignment.js")),d=i(r("./dist/core/Edge.js")),c=i(r("./dist/core/Point.js")),f=i(r("./dist/core/Connector.js")),S=i(r("./dist/core/Rect.js")),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.GetSupportsAssistants=function(){return!0},e}return o(e,t),e.prototype.PreProcessThisNode=function(t,e){if(this.ParentAlignment!=h.default.Left&&this.ParentAlignment!=h.default.Right)throw new Error("InvalidOperationException: Unsupported value for ParentAlignment");if(e.State.NumberOfSiblings=e.Element.IsCollapsed?0:e.ChildCount,e.State.NumberOfSiblings>0&&e.Level>0){e.State.NumberOfSiblingColumns=1,e.State.NumberOfSiblingRows=e.ChildCount;var r=s.default.Special(s.default.None,e.Element.Id,!1);e.AddRegularChildBox(r)}},e.prototype.ApplyVerticalLayout=function(t,e){var r=e.BranchRoot;0==r.Level&&(r.State.SiblingsRowV=new l.default(r.State.Top,r.State.Bottom)),null!=r.AssistantsRoot&&(u.default.CopyExteriorFrom(r.AssistantsRoot.State,r.State),u.default.VerticalLayout(t,r.AssistantsRoot));for(var n=new l.default(r.State.SiblingsRowV.From,null==r.AssistantsRoot?r.State.SiblingsRowV.To:r.State.BranchExterior.Bottom),o=0;o<r.State.NumberOfSiblings;o++){var i=r.Children[o],a=i.State,s=n.To+(0==o?this.ParentChildSpacing:this.SiblingSpacing);u.default.MoveTo(i.State,a.Left,s),i.State.BranchExterior=S.default.from(i.State.Size,i.State.TopLeft);var h=new l.default(s,s+a.Size.Height);(i=r.Children[o]).State.SiblingsRowV=h,u.default.VerticalLayout(t,i);var d=i.State.BranchExterior.Bottom;n=new l.default(h.From,Math.max(d,h.To))}},e.prototype.ApplyHorizontalLayout=function(t,e){var r=e.BranchRoot,n=r.State;null!=r.AssistantsRoot&&u.default.HorizontalLayout(t,r.AssistantsRoot);for(var o=0;o<n.NumberOfSiblings;o++){var i=r.Children[o];u.default.HorizontalLayout(t,i)}var a=u.default.AlignHorizontalCenters(t,e,this.EnumerateColumn(r));if(r.Level>0&&r.ChildCount>0){var s=r.State,l=void 0;if(this.ParentAlignment==h.default.Left){l=s.CenterH+this.ParentConnectorShield/2-a.From}else{if(this.ParentAlignment!=h.default.Right)throw new Error("InvalidOperationException: Invalid ParentAlignment setting");l=s.CenterH-this.ParentConnectorShield/2-a.To}u.default.MoveChildrenOnly(t,e,l);var d=r.Level>0?r.Children[r.ChildCount-1]:null;if(null!=d){var c=r.State.Bottom,f=r.Children[r.ChildCount-2].State.Bottom;u.default.AdjustSpacer(d.State,s.CenterH-this.ParentConnectorShield/2,c,this.ParentConnectorShield,f-c),t.MergeSpacer(d)}}},e.prototype.EnumerateColumn=function(t){for(var e=[],r=0;r<t.State.NumberOfSiblings;r++)e.push(t.Children[r]);return e},e.prototype.RouteConnectors=function(t,e){if(0!=e.ChildCount){var r=1+e.State.NumberOfSiblings,n=Array(r),o=e.State,i=o.CenterH,a=e.Children[e.State.NumberOfSiblings-1].State.CenterV-e.State.Bottom;n[0]=new d.default(new c.default(i,o.Bottom),new c.default(i,o.Bottom+a));for(var s=0;s<e.State.NumberOfSiblings;s++){var l=e.Children[s].State,u=this.ParentAlignment==h.default.Left?l.Left:l.Right;n[1+s]=new d.default(new c.default(i,l.CenterV),new c.default(u,l.CenterV))}e.State.Connector=new f.default(n)}},e}(a.default);e.default=p},"./dist/core/Size.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t,e){this.Width=t,this.Height=e};e.default=n},"./dist/core/StackOrientation.js":function(t,e,r){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.InvalidValue=0]="InvalidValue",t[t.SingleRowHorizontal=1]="SingleRowHorizontal",t[t.SingleColumnVertical=2]="SingleColumnVertical"}(n||(n={})),e.default=n},"./dist/core/StackingLayoutStrategy.js":function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=a(r("./dist/core/LayoutStrategyBase.js")),l=a(r("./dist/core/Dimensions.js")),u=a(r("./dist/core/LayoutAlgorithm.js")),h=a(r("./dist/core/BranchParentAlignment.js")),d=a(r("./dist/core/Size.js")),c=a(r("./dist/core/Rect.js")),f=a(r("./dist/core/StackOrientation.js")),S=function(t){function e(){var e=t.call(this)||this;return e.GetSupportsAssistants=function(){return!1},e.Orientation=f.default.SingleRowHorizontal,e.ParentAlignment=h.default.InvalidValue,e.ChildConnectorHookLength=0,e.ParentConnectorShield=0,e.SiblingSpacing=5,e}return o(e,t),e.prototype.PreProcessThisNode=function(t,e){if(e.State.NumberOfSiblings=e.Element.IsCollapsed?0:e.ChildCount,e.State.NumberOfSiblings>0&&this.Orientation!=f.default.SingleRowHorizontal&&this.Orientation!=f.default.SingleColumnVertical)throw new Error("InvalidOperationException: Unsupported value for orientation: "+this.Orientation)},e.prototype.ApplyVerticalLayout=function(t,e){var r=e.BranchRoot;if(0==r.Level&&(r.State.SiblingsRowV=new l.default(r.State.Top,r.State.Bottom)),0!=r.State.NumberOfSiblings){var n=l.default.MinMax();if(this.Orientation==f.default.SingleRowHorizontal){for(var o=null==r.AssistantsRoot?r.State.SiblingsRowV.To+this.ParentChildSpacing:r.State.BranchExterior.Bottom+this.ParentChildSpacing,i=0;i<r.State.NumberOfSiblings;i++){var a=(d=r.Children[i]).State;u.default.MoveTo(d.State,0,o),d.State.BranchExterior=c.default.from(d.State.Size,d.State.TopLeft),n=l.default.add(n,new l.default(o,o+a.Size.Height))}n=new l.default(n.From,n.To);for(i=0;i<r.State.NumberOfSiblings;i++){(d=r.Children[i]).State.SiblingsRowV=n,u.default.VerticalLayout(t,d)}}else if(this.Orientation==f.default.SingleColumnVertical)for(var s=new l.default(r.State.SiblingsRowV.From,r.State.SiblingsRowV.To),h=0;h<r.State.NumberOfSiblings;h++){a=(d=r.Children[h]).State;var d,S=s.To+(0==h?this.ParentChildSpacing:this.SiblingSpacing);u.default.MoveTo(d.State,a.Left,S),d.State.BranchExterior=c.default.from(d.State.Size,d.State.TopLeft);var p=new l.default(S,S+a.Size.Height);(d=r.Children[h]).State.SiblingsRowV=p,u.default.VerticalLayout(t,d);var g=d.State.BranchExterior.Bottom;s=new l.default(p.From,Math.max(g,p.To))}}},e.prototype.ApplyHorizontalLayout=function(t,e){var r,n,o=e.BranchRoot;try{for(var a=i(o.Children),s=a.next();!s.done;s=a.next()){var l=s.value;u.default.HorizontalLayout(t,l)}}catch(t){r={error:t}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}if(o.ChildCount>0)if(this.Orientation==f.default.SingleRowHorizontal){var h=o.Children[o.State.NumberOfSiblings-1].State.Right-o.Children[0].State.Left;o.State.Size=new d.default(Math.max(o.State.Size.Width,h),o.State.Size.Height);var c=(o.Children[0].State.Left+o.Children[o.ChildCount-1].State.Right)/2,S=o.State.CenterH-c;u.default.MoveChildrenOnly(t,e,S)}else if(this.Orientation==f.default.SingleColumnVertical){u.default.AlignHorizontalCenters(t,e,o.Children);c=o.Children[0].State.CenterH,S=o.State.CenterH-c;u.default.MoveChildrenOnly(t,e,S)}},e.prototype.RouteConnectors=function(t,e){},e}(s.default);e.default=S},"./dist/core/Step.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,r,n){this.Node=t,this.X=e,this.Top=r,this.Bottom=n}return t.prototype.ChangeTop=function(e){return new t(this.Node,this.X,e,this.Bottom)},t.prototype.ChangeBottom=function(e){return new t(this.Node,this.X,this.Top,e)},t.prototype.ChangeOwner=function(e,r){return new t(e,r,this.Top,this.Bottom)},t.prototype.ChangeX=function(e){return new t(this.Node,e,this.Top,this.Bottom)},t}();e.default=n},"./dist/core/Utils.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.peek=void 0;e.peek=function(t){return t[t.length-1]}},"./dist/core/index.js":function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),o=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),o(r("./dist/core/Boundary.js"),e);var i=r("./dist/core/Boundary.js");Object.defineProperty(e,"Boundary",{enumerable:!0,get:function(){return i.default}}),o(r("./dist/core/BoundaryChangedEventArgs.js"),e);var a=r("./dist/core/BoundaryChangedEventArgs.js");Object.defineProperty(e,"BoundaryChangedEventArgs",{enumerable:!0,get:function(){return a.default}}),o(r("./dist/core/Box.js"),e);var s=r("./dist/core/Box.js");Object.defineProperty(e,"Box",{enumerable:!0,get:function(){return s.default}}),o(r("./dist/core/BoxContainer.js"),e);var l=r("./dist/core/BoxContainer.js");Object.defineProperty(e,"BoxContainer",{enumerable:!0,get:function(){return l.default}}),o(r("./dist/core/BoxTree.js"),e);var u=r("./dist/core/BoxTree.js");Object.defineProperty(e,"BoxTree",{enumerable:!0,get:function(){return u.default}}),o(r("./dist/core/BranchParentAlignment.js"),e);var h=r("./dist/core/BranchParentAlignment.js");Object.defineProperty(e,"BranchParentAlignment",{enumerable:!0,get:function(){return h.default}}),o(r("./dist/core/Connector.js"),e);var d=r("./dist/core/Connector.js");Object.defineProperty(e,"Connector",{enumerable:!0,get:function(){return d.default}}),o(r("./dist/core/Diagram.js"),e);var c=r("./dist/core/Diagram.js");Object.defineProperty(e,"Diagram",{enumerable:!0,get:function(){return c.default}}),o(r("./dist/core/DiagramLayoutSettings.js"),e);var f=r("./dist/core/DiagramLayoutSettings.js");Object.defineProperty(e,"DiagramLayoutSettings",{enumerable:!0,get:function(){return f.default}}),o(r("./dist/core/DiagramLayoutTemplates.js"),e);var S=r("./dist/core/DiagramLayoutTemplates.js");Object.defineProperty(e,"DiagramLayoutTemplates",{enumerable:!0,get:function(){return S.default}}),o(r("./dist/core/Dimensions.js"),e);var p=r("./dist/core/Dimensions.js");Object.defineProperty(e,"Dimensions",{enumerable:!0,get:function(){return p.default}}),o(r("./dist/core/Edge.js"),e);var g=r("./dist/core/Edge.js");Object.defineProperty(e,"Edge",{enumerable:!0,get:function(){return g.default}}),o(r("./dist/core/FishboneAssistantsLayoutStrategy.js"),e);var m=r("./dist/core/FishboneAssistantsLayoutStrategy.js");Object.defineProperty(e,"FishboneAssistantsLayoutStrategy",{enumerable:!0,get:function(){return m.default}}),o(r("./dist/core/LayoutAlgorithm.js"),e);var y=r("./dist/core/LayoutAlgorithm.js");Object.defineProperty(e,"LayoutAlgorithm",{enumerable:!0,get:function(){return y.default}}),o(r("./dist/core/LayoutLevel.js"),e);var b=r("./dist/core/LayoutLevel.js");Object.defineProperty(e,"LayoutLevel",{enumerable:!0,get:function(){return b.default}}),o(r("./dist/core/LayoutState.js"),e);var C=r("./dist/core/LayoutState.js");Object.defineProperty(e,"LayoutState",{enumerable:!0,get:function(){return C.default}}),o(r("./dist/core/LayoutStateOperationChangedEventArgs.js"),e);var v=r("./dist/core/LayoutStateOperationChangedEventArgs.js");Object.defineProperty(e,"LayoutStateOperationChangedEventArgs",{enumerable:!0,get:function(){return v.default}}),o(r("./dist/core/LayoutStrategyBase.js"),e);var w=r("./dist/core/LayoutStrategyBase.js");Object.defineProperty(e,"LayoutStrategyBase",{enumerable:!0,get:function(){return w.default}}),o(r("./dist/core/LinearLayoutStrategy.js"),e);var L=r("./dist/core/LinearLayoutStrategy.js");Object.defineProperty(e,"LinearLayoutStrategy",{enumerable:!0,get:function(){return L.default}}),o(r("./dist/core/MultiLineFishboneLayoutStrategy.js"),e);var B=r("./dist/core/MultiLineFishboneLayoutStrategy.js");Object.defineProperty(e,"MultiLineFishboneLayoutStrategy",{enumerable:!0,get:function(){return B.default}}),o(r("./dist/core/MultiLineHangerLayoutStrategy.js"),e);var R=r("./dist/core/MultiLineHangerLayoutStrategy.js");Object.defineProperty(e,"MultiLineHangerLayoutStrategy",{enumerable:!0,get:function(){return R.default}}),o(r("./dist/core/Node.js"),e);var x=r("./dist/core/Node.js");Object.defineProperty(e,"Node",{enumerable:!0,get:function(){return x.default}}),o(r("./dist/core/NodeLayoutInfo.js"),e);var O=r("./dist/core/NodeLayoutInfo.js");Object.defineProperty(e,"NodeLayoutInfo",{enumerable:!0,get:function(){return O.default}}),o(r("./dist/core/Operation.js"),e);var I=r("./dist/core/Operation.js");Object.defineProperty(e,"Operation",{enumerable:!0,get:function(){return I.default}}),o(r("./dist/core/Point.js"),e);var P=r("./dist/core/Point.js");Object.defineProperty(e,"Point",{enumerable:!0,get:function(){return P.default}}),o(r("./dist/core/Rect.js"),e);var E=r("./dist/core/Rect.js");Object.defineProperty(e,"Rect",{enumerable:!0,get:function(){return E.default}}),o(r("./dist/core/SingleColumnLayoutStrategy.js"),e);var A=r("./dist/core/SingleColumnLayoutStrategy.js");Object.defineProperty(e,"SingleColumnLayoutStrategy",{enumerable:!0,get:function(){return A.default}}),o(r("./dist/core/Size.js"),e);var N=r("./dist/core/Size.js");Object.defineProperty(e,"Size",{enumerable:!0,get:function(){return N.default}}),o(r("./dist/core/StackOrientation.js"),e);var T=r("./dist/core/StackOrientation.js");Object.defineProperty(e,"StackOrientation",{enumerable:!0,get:function(){return T.default}}),o(r("./dist/core/StackingLayoutStrategy.js"),e);var _=r("./dist/core/StackingLayoutStrategy.js");Object.defineProperty(e,"StackingLayoutStrategy",{enumerable:!0,get:function(){return _.default}}),o(r("./dist/core/Step.js"),e);var M=r("./dist/core/Step.js");Object.defineProperty(e,"Step",{enumerable:!0,get:function(){return M.default}}),o(r("./dist/core/Utils.js"),e)},"./dist/index.js":function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),o=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||n(e,t,r)},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=i(r("./dist/OrgChart.js"));o(r("./dist/OrgChart.js"),e),e.default=a.default,o(r("./dist/Animated.js"),e);var s=r("./dist/Animated.js");Object.defineProperty(e,"Animated",{enumerable:!0,get:function(){return s.default}}),o(r("./dist/core/index.js"),e)},"./lib/index.ts":function(t,e,r){"use strict";r.d(e,"a",(function(){return K})),r.d(e,"b",(function(){return v})),r.d(e,"c",(function(){return x})),r.d(e,"d",(function(){return P})),r.d(e,"e",(function(){return N})),r.d(e,"f",(function(){return y})),r.d(e,"g",(function(){return M})),r.d(e,"h",(function(){return j})),r.d(e,"i",(function(){return D})),r.d(e,"j",(function(){return F})),r.d(e,"k",(function(){return g})),r.d(e,"l",(function(){return k})),r.d(e,"m",(function(){return u})),r.d(e,"n",(function(){return G})),r.d(e,"o",(function(){return X}));var n,o,i=r("./node_modules/react/index.js"),a=r.n(i);class s{constructor(t,e,r,n){this.Node=t,this.X=e,this.Top=r,this.Bottom=n}ChangeTop(t){return new s(this.Node,this.X,t,this.Bottom)}ChangeBottom(t){return new s(this.Node,this.X,this.Top,t)}ChangeOwner(t,e){return new s(t,e,this.Top,this.Bottom)}ChangeX(t){return new s(this.Node,t,this.Top,this.Bottom)}}class l{constructor(t,e){this.X=t,this.Y=e}MoveH(t){return new l(this.X+t,this.Y)}}class u{constructor(t,e){this.Width=t,this.Height=e}}class h{get BottomRight(){return new l(this.TopLeft.X+this.Size.Width,this.TopLeft.Y+this.Size.Height)}get Left(){return this.TopLeft.X}get Right(){return this.TopLeft.X+this.Size.Width}get CenterH(){return this.TopLeft.X+this.Size.Width/2}get CenterV(){return this.TopLeft.Y+this.Size.Height/2}get Top(){return this.TopLeft.Y}get Bottom(){return this.TopLeft.Y+this.Size.Height}constructor(t,e,r,n){if(r<0)throw new Error("Width out of range");if(n<0)throw new Error("Height out of range");this.TopLeft=new l(t,e),this.Size=new u(r,n)}static from(t,e=new l(0,0)){return new h(e.X,e.Y,t.Width,t.Height)}static add(t,e){const r=Math.min(t.Left,e.Left),n=Math.min(t.Top,e.Top),o=Math.max(t.Right,e.Right),i=Math.max(t.Bottom,e.Bottom);return new h(r,n,o-r,i-n)}MoveH(t){return h.from(this.Size,new l(this.Left+t,this.Top))}}class d{get IsDataBound(){return!!this.DataId}static Special(t,e,r){return new d(null,t,e,!0,r,!1)}constructor(t,e,r,n,o,i){if(0==e)throw new Error("Invalid "+e);this.Id=e,this.ParentId=r,this.DataId=t,this.IsSpecial=n,this.IsAssistant=i,this.DisableCollisionDetection=o,this.AssistantLayoutStrategyId=null,this.LayoutStrategyId=null,this.IsCollapsed=!1,this.Size=new u(0,0)}}d.None=-1;class c{static MinMax(){return new c(Number.MAX_VALUE,Number.MIN_VALUE)}constructor(t,e){this.From=t,this.To=e}static add(t,e){return new c(Math.min(t.From,e.From),Math.max(t.To,e.To))}}class f{constructor(){this._effectiveLayoutStrategy=null,this.IsHidden=!1,this.Connector=null,this.NumberOfSiblings=0,this.NumberOfSiblingRows=0,this.NumberOfSiblingColumns=0,this.Size=new u(0,0),this.TopLeft=new l(0,0),this.BranchExterior=new h(0,0,0,0),this.SiblingsRowV=new c(0,0)}set EffectiveLayoutStrategy(t){this._effectiveLayoutStrategy=t}get RequireLayoutStrategy(){if(null==this._effectiveLayoutStrategy)throw new Error("EffectiveLayoutStrategy is not set");return this._effectiveLayoutStrategy}get Left(){if(null==this.TopLeft)throw Error("TopLeft is null");return this.TopLeft.X}get Right(){if(null==this.TopLeft)throw Error("TopLeft is null");if(null==this.Size)throw Error("Size is null");return this.TopLeft.X+this.Size.Width}get Top(){if(null==this.TopLeft)throw Error("TopLeft is null");if(null==this.Size)throw Error("Size is null");return this.TopLeft.Y}get Bottom(){if(null==this.TopLeft)throw Error("TopLeft is null");if(null==this.Size)throw Error("Size is null");return this.TopLeft.Y+this.Size.Height}get CenterH(){if(null==this.TopLeft)throw Error("TopLeft is null");if(null==this.Size)throw Error("Size is null");return this.TopLeft.X+this.Size.Width/2}get CenterV(){if(null==this.TopLeft)throw Error("TopLeft is null");if(null==this.Size)throw Error("Size is null");return this.TopLeft.Y+this.Size.Height/2}}class S{constructor(t){this.Level=0,this.Children=[],this.AssistantsRoot=null,this.ParentNode=null,this.Element=t,this.State=new f}get ChildCount(){var t;return(null==(t=this.Children)?void 0:t.length)||0}get IsAssistantRoot(){var t;return(null==(t=this.ParentNode)?void 0:t.AssistantsRoot)==this}AddAssistantChild(t){return null==this.AssistantsRoot&&(this.AssistantsRoot=new S(d.Special(d.None,this.Element.Id,!0)),this.AssistantsRoot.ParentNode=this,this.AssistantsRoot.Level=this.AssistantsRoot.Level+1),this.AssistantsRoot.AddRegularChild(t),this}AddRegularChild(t){return this.InsertRegularChild(this.ChildCount,t)}AddRegularChildBox(t){return this.InsertRegularChildBoxByIndex(this.ChildCount,t)}InsertRegularChildBox(t){return this.InsertRegularChildBoxByIndex(this.ChildCount,t)}InsertRegularChildBoxByIndex(t,e){return this.InsertRegularChild(t,new S(e))}InsertRegularChild(t,e){return null==this.Children&&(this.Children=[]),this.Children.splice(t,0,e),e.ParentNode=this,e.Level=this.Level+1,this}IterateChildFirst(t){if(null!=this.AssistantsRoot&&!this.AssistantsRoot.IterateChildFirst(t))return!1;if(null!=this.Children)for(const e of this.Children)if(!e.IterateChildFirst(t))return!1;return t(this)}IterateParentFirst(t,e){var r;if(!t(this))return e&&e(this),!1;if(null==(r=this.AssistantsRoot)||r.IterateParentFirst(t,e),null!=this.Children)for(const r of this.Children)r.IterateParentFirst(t,e);return e&&e(this),!0}SuppressAssistants(){if(null!=this.AssistantsRoot){for(const t of this.AssistantsRoot.Children)this.AddRegularChild(t);this.AssistantsRoot=null}}}class p{constructor(){this.Depth=0,this.Root=null,this.Nodes=new Map}IterateChildFirst(t){if(null==this.Root)throw Error("Root is null");return this.Root.IterateChildFirst(t)}IterateParentFirst(t,e){if(null==this.Root)throw Error("Root is null");this.Root.IterateParentFirst(t,e)}UpdateHierarchyStats(){this.Depth=0,this.IterateParentFirst(t=>(null!=t.ParentNode?(t.Level=t.ParentNode.Level,t.ParentNode.IsAssistantRoot||(t.Level=t.Level+1),this.Depth=Math.max(1+t.Level,this.Depth)):(t.Level=0,this.Depth=1),!0))}static Build(t){const e=new p;let r;for(r of t.Diagram.Boxes.BoxesById.values()){const t=new S(r);e.Nodes.set(r.Id,t)}for(const t of e.Nodes.values()){const r=t.Element.ParentId,n=e.Nodes.get(r);if(n)t.Element.IsAssistant&&n.Element.ParentId!=d.None?n.AddAssistantChild(t):n.AddRegularChild(t);else{if(null!=e.Root)throw new Error("InvalidOperationException: More then one root found: "+t.Element.Id);e.Root=t}}return e}}(o=n||(n={}))[o.Idle=0]="Idle",o[o.Preparing=1]="Preparing",o[o.PreprocessVisualTree=2]="PreprocessVisualTree",o[o.VerticalLayout=3]="VerticalLayout",o[o.HorizontalLayout=4]="HorizontalLayout",o[o.ConnectorsLayout=5]="ConnectorsLayout",o[o.Completed=6]="Completed";var g=n;const m=t=>t[t.length-1];class y{static ComputeBranchVisualBoundingRect(t){let e=new h(0,0,0,0),r=!1;if(null==t.Root)throw Error("Root is null");return t.Root.IterateParentFirst(t=>{var n=t.Element;if(!t.State.IsHidden&&!n.IsSpecial){if(null==t.State.Size)throw Error("Size is null");if(null==t.State.TopLeft)throw Error("TopLeft is null");r?e=h.add(e,h.from(t.State.Size,t.State.TopLeft)):(r=!0,e=h.from(t.State.Size,t.State.TopLeft))}return!n.IsCollapsed}),e}static Apply(t){var e,r;if(t.Diagram.Boxes&&null==t.Diagram.Boxes.SystemRoot)throw new Error("SystemRoot is not initialized on the box container");t.CurrentOperation=g.Preparing;var n=p.Build(t);if(t.Diagram.VisualTree=n,null==n.Root||t.Diagram.Boxes&&n.Root.Element.Id!=(null==(e=t.Diagram.Boxes.SystemRoot)?void 0:e.Id))throw new Error("SystemRoot is not on the top of the visual tree");if(n.UpdateHierarchyStats(),t.AttachVisualTree(n),n.IterateParentFirst(t=>(t.State.IsHidden=null!=t.ParentNode&&(t.ParentNode.State.IsHidden||t.ParentNode.Element.IsCollapsed),!0)),t.CurrentOperation=g.PreprocessVisualTree,null!=t.BoxSizeFunc)for(const e of[...null==(r=t.Diagram.Boxes)?void 0:r.BoxesById.values()].filter(t=>t.IsDataBound))e.Size=t.BoxSizeFunc(e.DataId);for(const e of t.Diagram.Boxes.BoxesById.values())this.AssertBoxSize(e);n.IterateParentFirst(t=>(y.MoveTo(t.State,0,0),t.State.Size=t.Element.Size,t.State.BranchExterior=h.from(t.Element.Size,new l(0,0)),!0)),this.PreprocessVisualTree(t,n),n.UpdateHierarchyStats(),t.CurrentOperation=g.VerticalLayout,this.VerticalLayout(t,n.Root),t.CurrentOperation=g.HorizontalLayout,this.HorizontalLayout(t,n.Root),t.CurrentOperation=g.ConnectorsLayout,this.RouteConnectors(t,n),t.CurrentOperation=g.Completed}static AssertBoxSize(t){if(!(t.Size.Width>=0&&t.Size.Width<=1e9&&t.Size.Height>=0&&t.Size.Width<=1e9))throw new Error(`Box ${t.Id} has invalid size: ${t.Size.Width}x${t.Size.Height}`)}static PreprocessVisualTree(t,e){const r=t.Diagram.LayoutSettings.RequireDefaultLayoutStrategy(),n=t.Diagram.LayoutSettings.RequireDefaultAssistantLayoutStrategy(),o=[];o.push(r);const i=[];i.push(n),e.IterateParentFirst(e=>{var r;if(e.State.IsHidden)return!1;let n=null;if(null!=t.LayoutOptimizerFunc){var a=t.LayoutOptimizerFunc(e);a&&(n=t.Diagram.LayoutSettings.LayoutStrategies.get(a))}if(e.IsAssistantRoot){if(null==n&&(n=null!=(null==(r=e.ParentNode)?void 0:r.Element.AssistantLayoutStrategyId)?t.Diagram.LayoutSettings.LayoutStrategies.get(e.ParentNode.Element.AssistantLayoutStrategyId):m(i)),null==n)throw Error("Strategy is null. Maybe it allows null?");i.push(n)}else{if(null==n&&(n=null!=e.Element.LayoutStrategyId?t.Diagram.LayoutSettings.LayoutStrategies.get(e.Element.LayoutStrategyId):m(o)),null==n)throw Error("Strategy is null. Maybe it allows null?");o.push(n),n.SupportsAssistants||e.SuppressAssistants()}return e.State.EffectiveLayoutStrategy=n,e.State.RequireLayoutStrategy.PreProcessThisNode(t,e),!e.Element.IsCollapsed&&e.ChildCount>0||null!=e.AssistantsRoot},t=>{t.State.IsHidden||(t.IsAssistantRoot?i.pop():o.pop())})}static HorizontalLayout(t,e){if(e.State.IsHidden)throw new Error(`Branch root ${e.Element.Id} does not affect layout`);let r=t.PushLayoutLevel(e);try{(0==e.Level||(e.State.NumberOfSiblings>0||null!=e.AssistantsRoot)&&!e.Element.IsCollapsed)&&e.State.RequireLayoutStrategy.ApplyHorizontalLayout(t,r)}finally{t.PopLayoutLevel()}}static VerticalLayout(t,e){if(e.State.IsHidden)throw new Error(`Branch root ${e.Element.Id} does not affect layout`);var r=t.PushLayoutLevel(e);try{(0==e.Level||(e.State.NumberOfSiblings>0||null!=e.AssistantsRoot)&&!e.Element.IsCollapsed)&&e.State.RequireLayoutStrategy.ApplyVerticalLayout(t,r)}finally{t.PopLayoutLevel()}}static RouteConnectors(t,e){e.IterateParentFirst(e=>!(e.Element.IsCollapsed||0==e.State.NumberOfSiblings&&null==e.AssistantsRoot)&&(0==e.Level||!(e.Element.IsSpecial&&!e.IsAssistantRoot)&&(e.State.RequireLayoutStrategy.RouteConnectors(t,e),!0)))}static MoveChildrenOnly(t,e,r){const n=e.BranchRoot.Children;if(null==n||0==n.length)throw new Error("Should never be invoked when children not set");const o=t=>{if(!t.State.IsHidden)try{t.State.TopLeft=t.State.TopLeft.MoveH(r),t.State.BranchExterior=t.State.BranchExterior.MoveH(r)}catch(t){}return!0};for(const t of n)t.IterateChildFirst(o);e.Boundary.ReloadFromBranch(e.BranchRoot),e.BranchRoot.State.BranchExterior=e.Boundary.BoundingRect}static MoveOneChild(t,e,r){e.IterateChildFirst(t=>(t.State.IsHidden||(t.State.TopLeft=t.State.TopLeft.MoveH(r),t.State.BranchExterior=t.State.BranchExterior.MoveH(r)),!0))}static MoveBranch(t,e,r){this.MoveOneChild(t,e.BranchRoot,r),e.Boundary.ReloadFromBranch(e.BranchRoot),e.BranchRoot.State.BranchExterior=e.Boundary.BoundingRect}static AlignHorizontalCenters(t,e,r){let n=Number.MIN_VALUE;for(const t of r){var o=t.State.CenterH;o>n&&(n=o)}let i=Number.MAX_VALUE,a=Number.MIN_VALUE;for(const e of r){const r=e.State.CenterH;if(r!==n){const o=n-r;this.MoveOneChild(t,e,o)}i=Math.min(i,e.State.BranchExterior.Left),a=Math.max(a,e.State.BranchExterior.Right)}return e.Boundary.ReloadFromBranch(e.BranchRoot),new c(i,a)}static CopyExteriorFrom(t,e){t.TopLeft=e.TopLeft,t.Size=e.Size,t.BranchExterior=e.BranchExterior,t.SiblingsRowV=e.SiblingsRowV}static IsMinValue(t){return t<=Number.MIN_VALUE+Number.EPSILON}static IsMaxValue(t){return t>=Number.MAX_VALUE-Number.EPSILON}static IsZero(t){return t<=Number.EPSILON&&t>=-Number.EPSILON}static IsEqual(t,e){return Math.abs(t-e)<=Number.EPSILON}static MoveTo(t,e,r){t.TopLeft=new l(e,r)}static AdjustSpacer(t,e,r,n,o){t.TopLeft=new l(e,r),t.Size=new u(n,o),t.BranchExterior=new h(e,r,n,o)}}class b{constructor(t=!0){this._spacerMerger=null,this._boundingRect=null,this.Left=[],this.Right=[],t&&(this._spacerMerger=new b(!1))}get BoundingRect(){if(null==this._boundingRect)throw Error("BoundingRect is null");return this._boundingRect}set BoundingRect(t){this._boundingRect=t}PrepareForHorizontalLayout(t){if(this.Prepare(t),t.Element.DisableCollisionDetection)return;let e=t.State;this.Left.push(new s(t,e.Left,e.Top,e.Bottom)),this.Right.push(new s(t,e.Right,e.Top,e.Bottom))}Prepare(t){this.Left=[],this.Right=[],this.BoundingRect=h.from(t.State.Size,t.State.TopLeft)}VerticalMergeFrom(t){this.BoundingRect=h.add(this.BoundingRect,t.BoundingRect)}MergeFrom(t){if(t.BoundingRect.Top>=t.BoundingRect.Bottom)throw new Error("Cannot merge boundary of height "+(t.BoundingRect.Bottom-t.BoundingRect.Top));let e="r";for(;"\0"!=e;){let r="r"==e?this.Right:this.Left,n="r"==e?t.Right:t.Left,o=0,i=0;for(;i<n.length&&o<r.length;){let t=r[o],a=n[i];if(t.Bottom<=a.Top){o++;continue}if(a.Bottom<=t.Top){r.splice(o,0,a),i++,this.ValidateState();continue}let l="r"==e?t.X<=a.X:t.X>=a.X;y.IsEqual(t.Top,a.Top)?y.IsEqual(t.Bottom,a.Bottom)?(l&&(r[o]=a),o++,i++,this.ValidateState()):t.Bottom<a.Bottom?(l&&(r[o]=t.ChangeOwner(a.Node,a.X)),n[i]=a.ChangeTop(t.Bottom),o++,this.ValidateState()):(l&&(r[o]=t.ChangeTop(a.Bottom),r.splice(o,0,a),o++),i++,this.ValidateState()):y.IsEqual(t.Bottom,a.Bottom)?t.Top<a.Top?(l&&(r[o]=t.ChangeBottom(a.Top),r.splice(o+1,0,a),o++),o++,i++,this.ValidateState()):(l?r[o]=a:(r.splice(o,0,a.ChangeBottom(t.Top)),o++),o++,i++,this.ValidateState()):t.Top<a.Top&&t.Bottom<a.Bottom?(l&&(r[o]=t.ChangeBottom(a.Top),r.splice(o+1,0,new s(a.Node,a.X,a.Top,t.Bottom)),o++),n[i]=a.ChangeTop(t.Bottom),o++,this.ValidateState()):t.Top<a.Top&&t.Bottom>a.Bottom?(l&&(r[o]=t.ChangeBottom(a.Top),r.splice(o+1,0,a),r.splice(o+2,0,t.ChangeTop(a.Bottom)),o+=2),i++,this.ValidateState()):t.Bottom>a.Bottom?(l?(r[o]=t.ChangeTop(a.Bottom),r.splice(o,0,a)):r.splice(o,0,a.ChangeBottom(t.Top)),o++,i++,this.ValidateState()):(l?r[o]=a.ChangeBottom(t.Bottom):(r.splice(o,0,a.ChangeBottom(t.Top)),o++),n[i]=a.ChangeTop(t.Bottom),o++,this.ValidateState())}if(o==r.length)for(;i<n.length;)r.push(n[i]),i++,this.ValidateState();e="r"==e?"l":"\0"}this.BoundingRect=h.add(this.BoundingRect,t.BoundingRect)}ValidateState(){for(let t=1;t<this.Left.length;t++)if(this.Left[t].Top==this.Left[t].Bottom||this.Left[t].Top<this.Left[t-1].Bottom||this.Left[t].Top<=this.Left[t-1].Top||this.Left[t].Bottom<=this.Left[t].Top||this.Left[t].Bottom<=this.Left[t-1].Bottom)throw new Error("State error at Left index "+t);for(let t=1;t<this.Right.length;t++)if(this.Right[t].Top==this.Right[t].Bottom||this.Right[t].Top<this.Right[t-1].Bottom||this.Right[t].Top<=this.Right[t-1].Top||this.Right[t].Bottom<=this.Right[t].Top||this.Right[t].Bottom<=this.Right[t-1].Bottom)throw new Error("State error at Right index "+t)}MergeFromNode(t){if(!t.Element.DisableCollisionDetection&&t.State.Size&&!y.IsZero(t.State.Size.Height)){if(null==this._spacerMerger)throw Error("SpaceMerger is null");this._spacerMerger.PrepareForHorizontalLayout(t),this.MergeFrom(this._spacerMerger)}}ComputeOverlap(t,e,r){let n=0,o=0,i=0;for(;n<this.Right.length&&o<t.Left.length;){let a=this.Right[n],s=t.Left[o];if(a.Bottom<=s.Top)n++;else if(s.Bottom<=a.Top)o++;else{if(!a.Node.Element.DisableCollisionDetection&&!s.Node.Element.DisableCollisionDetection){const t=a.Node.Element.IsSpecial||s.Node.Element.IsSpecial?0:a.Node.Element.ParentId==s.Node.Element.ParentId?e:r,n=a.X+t-s.X;n>i&&(i=n)}a.Bottom>=s.Bottom&&o++,s.Bottom>=a.Bottom&&n++}}return i}ReloadFromBranch(t){let e=Number.MAX_VALUE,r=Number.MIN_VALUE;for(let t=0;t<this.Left.length;t++){let r=this.Left[t],n=r.Node.State.Left;this.Left[t]=r.ChangeX(n),e=Math.min(e,n)}for(let t=0;t<this.Right.length;t++){let e=this.Right[t],n=e.Node.State.Right;this.Right[t]=e.ChangeX(n),r=Math.max(r,n)}e=Math.min(t.State.Left,e),r=Math.max(t.State.Right,r),this.BoundingRect=h.from(new u(r-e,this.BoundingRect.Size.Height),new l(e,this.BoundingRect.Top))}}class C{constructor(t,e,r){this.Boundary=t,this.LayoutLevel=e,this.State=r}}class v{constructor(t){this._lastBoxId=0,this._boxesById=new Map,this._boxesByDataId=new Map,this.SystemRoot=null,t&&this.ReloadBoxes(t)}get BoxesById(){return this._boxesById}get BoxesByDataId(){return this._boxesByDataId}ReloadBoxes(t){this._boxesByDataId.clear(),this._boxesById.clear(),this._lastBoxId=0,this.SystemRoot=d.Special(++this._lastBoxId,d.None,!0),this._boxesById.set(this.SystemRoot.Id,this.SystemRoot);const e=new Map;for(const r of t.AllDataItemIds)e.set(r,this.NextBoxId());const r=t.GetDataItemFunc;for(const n of t.AllDataItemIds){const o=n?t.GetParentKeyFunc(n):null,i=o?e.get(o):this.SystemRoot.Id,a=e.get(n);null!=a&&null!=i&&this._AddBox(n,a,i,r(n).IsAssistant)}}AddBox(t,e,r){return this._AddBox(t,this.NextBoxId(),e,r)}_AddBox(t,e,r,n){const o=new d(t,e,r,!1,!1,n);return this._boxesById.set(o.Id,o),o.DataId&&this._boxesByDataId.set(o.DataId,o),o}NextBoxId(){return this._lastBoxId++,this._lastBoxId}}var w,L;(L=w||(w={}))[L.InvalidValue=0]="InvalidValue",L[L.Left=1]="Left",L[L.Center=2]="Center",L[L.Right=3]="Right";var B,R,x=w;class O{constructor(t){if(0==t.length)throw new Error("Need at least one segment");this.Segments=t}}class I{constructor(){this.BranchSpacing=50,this.DefaultAssistantLayoutStrategyId=null,this.DefaultLayoutStrategyId=null,this.BranchSpacing=50,this.LayoutStrategies=new Map}RequireDefaultLayoutStrategy(){const t=this.DefaultLayoutStrategyId;if(!t)throw new Error("DefaultLayoutStrategyId is null or not valid");const e=this.LayoutStrategies.get(t);if(!e)throw new Error("DefaultLayoutStrategyId is null or not valid");return e}RequireDefaultAssistantLayoutStrategy(){const t=this.DefaultAssistantLayoutStrategyId;if(!t)throw new Error("RequireDefaultAssistantLayoutStrategy is null or not valid");const e=this.LayoutStrategies.get(t);if(!e)throw new Error("RequireDefaultAssistantLayoutStrategy is null or not valid");return e}}class P{constructor(){this._visualTree=null,this._boxes=null,this.LayoutSettings=new I}get Boxes(){if(null==this._boxes)throw Error("Boxes is null");return this._boxes}set Boxes(t){this._visualTree=null,this._boxes=t}get VisualTree(){return this._visualTree}set VisualTree(t){this._visualTree=t}}class E{constructor(t,e){this.From=t,this.To=e}}class A{constructor(){this.ParentAlignment=x.InvalidValue,this.ParentChildSpacing=20,this.ParentConnectorShield=50,this.SiblingSpacing=20,this.ChildConnectorHookLength=5}get SupportsAssistants(){return this.GetSupportsAssistants()}}class N extends A{constructor(){super(...arguments),this.GetSupportsAssistants=()=>!1,this.MaxOnLeft=t=>Math.floor(t.State.NumberOfSiblings/2)+t.State.NumberOfSiblings%2,this.NeedCarrierProtector=t=>{var e;return 0==(null==(e=t.ParentNode)?void 0:e.ChildCount)}}PreProcessThisNode(t,e){if(e.State.NumberOfSiblings=e.ChildCount,e.State.NumberOfSiblings>0){e.State.NumberOfSiblingColumns=1,e.State.NumberOfSiblingRows=Math.floor(e.State.NumberOfSiblings/2),e.State.NumberOfSiblings%2!=0&&e.State.NumberOfSiblingRows++;var r=d.Special(d.None,e.Element.Id,!1);e.AddRegularChildBox(r)}}ApplyVerticalLayout(t,e){const r=e.BranchRoot;if(0==r.Level)throw new Error("Should never be invoked on root node");if(null==r.State.SiblingsRowV)throw Error("SiblingsRowV is null");let n=r.State.SiblingsRowV.To;const o=this.MaxOnLeft(r);for(var i=0;i<o;i++){const e=0==i?this.ParentChildSpacing:this.SiblingSpacing,a=r.Children[i],s=a.State;y.MoveTo(s,s.Left,n+e);let l=new c(s.Top,s.Bottom);const u=i+o;if(null==s.Size)throw Error("Size is null");if(u<r.State.NumberOfSiblings){const o=r.Children[u],i=o.State;if(y.MoveTo(i,i.Left,n+e),null==i.Size)throw Error("Size is null");i.Bottom>s.Bottom?y.MoveTo(s,s.Left,i.CenterV-s.Size.Height/2):i.Bottom<s.Bottom&&y.MoveTo(i,i.Left,s.CenterV-i.Size.Height/2),i.BranchExterior=h.from(i.Size,i.TopLeft),l=c.add(l,new c(i.Top,i.Bottom)),i.SiblingsRowV=l,y.VerticalLayout(t,o),n=i.BranchExterior.Bottom}s.BranchExterior=h.from(s.Size,s.TopLeft),s.SiblingsRowV=l,y.VerticalLayout(t,a),n=Math.max(n,s.BranchExterior.Bottom)}}ApplyHorizontalLayout(t,e){var r=e.BranchRoot;0==r.Level&&(r.State.SiblingsRowV=new c(r.State.Top,r.State.Bottom));for(var n=!0,o=0,i=this.MaxOnLeft(r),a=0;a<r.State.NumberOfSiblings;a++){var s=r.Children[a];if(y.HorizontalLayout(t,s),++o==i&&n){y.AlignHorizontalCenters(t,e,this.EnumerateSiblings(r,0,i)),n=!1,o=0;for(var l=Number.MIN_VALUE,u=0;u<=a;u++)l=Math.max(l,r.Children[u].State.BranchExterior.Right);if(r.State.NumberOfSiblings%2!=0)l=Math.max(l,s.State.Right);else{var h=r.Children[r.State.NumberOfSiblings-1];l=h.Element.IsCollapsed||0==h.ChildCount?Math.max(l,s.State.Right):Math.max(l,s.State.BranchExterior.Right)}const d=r.Children[r.State.NumberOfSiblings];y.AdjustSpacer(d.State,l,r.State.Bottom,this.ParentConnectorShield,r.State.BranchExterior.Bottom-r.State.Bottom),e.Boundary.MergeFromNode(d)}}if(y.AlignHorizontalCenters(t,e,this.EnumerateSiblings(r,i,r.State.NumberOfSiblings)),r.Level>0&&r.State.NumberOfSiblings>0){let n=r.Children[r.State.NumberOfSiblings].State.CenterH;const o=r.State.CenterH-n;y.MoveChildrenOnly(t,e,o)}}RouteConnectors(t,e){var r=e.State.NumberOfSiblings;if(0!=r){this.NeedCarrierProtector(e)&&r++;for(var n=[],o=0,i=this.MaxOnLeft(e),a=e.Children[e.State.NumberOfSiblings].State,s=a.CenterH,u=!0,h=0,d=Number.MIN_VALUE,c=0;c<e.State.NumberOfSiblings;c++){var f=u?e.Children[c].State.Right:e.Children[c].State.Left,S=e.Children[c].State.CenterV;d=Math.max(d,S),n[o++]=new E(new l(s,S),new l(f,S)),++h==i&&(h=0,u=!u)}this.NeedCarrierProtector(e)&&(n[e.State.NumberOfSiblings]=new E(new l(a.CenterH,a.Top),new l(a.CenterH,d))),e.State.Connector=new O(n)}}EnumerateSiblings(t,e,r){const n=[];for(var o=e;o<r;o++)n.push(t.Children[o]);return n}}class T{constructor(t,e){this.BranchRoot=t,this.Boundary=e}}class _{constructor(t){this.State=t,this.CurrentOperation=t.CurrentOperation}}class M{constructor(t){this._currentOperation=g.Idle,this._layoutStack=[],this._pooledBoundaries=[],this.BoxSizeFunc=null,this.LayoutOptimizerFunc=null,this.BoundaryChanged=null,this.OperationChanged=null,this.Diagram=t}get CurrentOperation(){return this._currentOperation}set CurrentOperation(t){this._currentOperation=t,this.OperationChanged&&this.OperationChanged(this,new _(this))}AttachVisualTree(t){for(;this._pooledBoundaries.length<t.Depth;)this._pooledBoundaries.push(new b)}PushLayoutLevel(t){0==this._pooledBoundaries.length&&this._pooledBoundaries.push(new b);const e=this._pooledBoundaries.pop();if(null==e)throw Error("Boundary is null");switch(this.CurrentOperation){case g.VerticalLayout:e.Prepare(t);break;case g.HorizontalLayout:e.PrepareForHorizontalLayout(t);break;default:throw new Error("This operation can only be invoked when performing vertical or horizontal layouts")}if(null==e)throw Error("Boundary cannot be null");var r=new T(t,e);return this._layoutStack.push(r),this.BoundaryChanged&&this.BoundaryChanged(this,new C(e,r,this)),r}MergeSpacer(t){if(this.CurrentOperation!=g.HorizontalLayout)throw new Error("Spacers can only be merged during horizontal layout");if(0==this._layoutStack.length)throw new Error("Cannot merge spacers at top nesting level");const e=m(this._layoutStack);if(null==e)throw Error("Level is null");e.Boundary.MergeFromNode(t),this.BoundaryChanged&&this.BoundaryChanged(this,new C(e.Boundary,e,this))}PopLayoutLevel(){const t=this._layoutStack.pop();if(null==t)throw Error("innerLevel is null");if(this.BoundaryChanged&&this.BoundaryChanged(this,new C(t.Boundary,t,this)),this._layoutStack.length>0){const e=m(this._layoutStack);if(null==e)throw Error("higherLevel is null");switch(this.CurrentOperation){case g.VerticalLayout:e.Boundary.VerticalMergeFrom(t.Boundary),e.BranchRoot.State.BranchExterior=e.Boundary.BoundingRect;break;case g.HorizontalLayout:if(e.BranchRoot.AssistantsRoot!=t.BranchRoot){const r=e.BranchRoot.State.RequireLayoutStrategy,n=e.Boundary.ComputeOverlap(t.Boundary,r.SiblingSpacing,this.Diagram.LayoutSettings.BranchSpacing);n>0&&(y.MoveBranch(this,t,n),this.BoundaryChanged&&this.BoundaryChanged(this,new C(t.Boundary,t,this)))}e.Boundary.MergeFrom(t.Boundary),e.BranchRoot.State.BranchExterior=new h(e.Boundary.BoundingRect.Left,e.BranchRoot.State.BranchExterior.Top,e.Boundary.BoundingRect.Size.Width,e.BranchRoot.State.BranchExterior.Size.Height);break;default:throw new Error("This operation can only be invoked when performing vertical or horizontal layouts")}this.BoundaryChanged&&this.BoundaryChanged(this,new C(e.Boundary,e,this))}this._pooledBoundaries.push(t.Boundary)}}class j extends A{constructor(){super(...arguments),this.GetSupportsAssistants=()=>!0}PreProcessThisNode(t,e){if(e.ChildCount>0&&(e.State.NumberOfSiblings=e.Element.IsCollapsed?0:e.ChildCount,!e.Element.IsCollapsed)){const t=d.Special(d.None,e.Element.Id,!1);e.AddRegularChildBox(t);const r=d.Special(d.None,e.Element.Id,!1);e.AddRegularChildBox(r)}}ApplyVerticalLayout(t,e){let r=e.BranchRoot;if(0==r.Level&&(r.State.SiblingsRowV=new c(r.State.Top,r.State.Bottom)),null!=r.AssistantsRoot&&(y.CopyExteriorFrom(r.AssistantsRoot.State,r.State),y.VerticalLayout(t,r.AssistantsRoot)),0==r.State.NumberOfSiblings)return;let n,o=c.MinMax();if(null==r.AssistantsRoot){if(null==r.State.SiblingsRowV)throw Error("SiblingsRowV is null");n=r.State.SiblingsRowV.To+this.ParentChildSpacing}else n=r.State.BranchExterior.Bottom+this.ParentChildSpacing;for(let t=0;t<r.State.NumberOfSiblings;t++){let e=r.Children[t],i=e.State;if(y.MoveTo(e.State,0,n),null==e.State.Size)throw Error("Size is null");if(e.State.BranchExterior=h.from(e.State.Size,e.State.TopLeft),null==i.Size)throw Error("Size is null");o=c.add(o,new c(n,n+i.Size.Height))}o=new c(o.From,o.To);for(let e=0;e<r.State.NumberOfSiblings;e++){let n=r.Children[e];n.State.SiblingsRowV=o,y.VerticalLayout(t,n)}}ApplyHorizontalLayout(t,e){let r=e.BranchRoot;null!=r.AssistantsRoot&&y.HorizontalLayout(t,r.AssistantsRoot);for(let e=0;e<r.State.NumberOfSiblings;e++){let n=r.Children[e];y.HorizontalLayout(t,n)}if(r.Level>0&&r.ChildCount>0){let n=r.State,o=r.Children[0].State.CenterH,i=r.Children[r.State.NumberOfSiblings-1].State.CenterH,a=1==r.State.NumberOfSiblings||this.ParentAlignment==x.Center?o+(i-o)/2:this.ParentAlignment==x.Left?o+this.ChildConnectorHookLength:i-this.ChildConnectorHookLength,s=n.CenterH,l=s-a;y.MoveChildrenOnly(t,e,l);let u=r.Children[r.State.NumberOfSiblings];if(null==r.Children[0].State.SiblingsRowV)throw Error("SiblingsRowV is null");y.AdjustSpacer(u.State,s-this.ParentConnectorShield/2,n.Bottom,this.ParentConnectorShield,r.Children[0].State.SiblingsRowV.From-n.Bottom),t.MergeSpacer(u);let h=r.Children[0].State,d=r.Children[r.State.NumberOfSiblings+1];if(null==h.SiblingsRowV)throw Error("SiblingsRowV is null");y.AdjustSpacer(d.State,h.Left,h.SiblingsRowV.From-this.ParentChildSpacing,r.Children[r.State.NumberOfSiblings-1].State.Right-h.Left,this.ParentChildSpacing),t.MergeSpacer(d)}}RouteConnectors(t,e){let r=e.State.NumberOfSiblings,n=0==r?0:1==r?1:2+r;if(0==n)return void(e.State.Connector=null);let o=[],i=e.State,a=i.CenterH;if(null==e.Children)throw new Error("State is present, but children not set");if(1==n)o[0]=new E(new l(a,i.Bottom),new l(a,e.Children[0].State.Top));else{if(null==e.Children[0].State.SiblingsRowV)throw Error("SiblingsRowV is null");let t=e.Children[0].State.SiblingsRowV.From-i.Bottom;o[0]=new E(new l(a,i.Bottom),new l(a,i.Bottom+t-this.ChildConnectorHookLength));for(let t=0;t<r;t++){let r=e.Children[t].State,n=r.CenterH;o[1+t]=new E(new l(n,r.Top),new l(n,r.Top-this.ChildConnectorHookLength))}o[n-1]=new E(new l(o[1].To.X,o[1].To.Y),new l(o[n-2].To.X,o[1].To.Y))}e.State.Connector=new O(o)}}class V{constructor(t,e){this.Group=0,this.FromIndex=0,this.Count=0,this.MaxOnLeft=0,this._numberOfSiblings=t,this._numberOfGroups=e}CountInGroup(){let t=2*this._numberOfGroups,e=0,r=2*this.Group+2,n=0;for(;;){let o=n>=this._numberOfSiblings-t?this._numberOfSiblings-n:t;if(!(o>=r)){r--,o>=r&&e++;break}e+=2,n+=t}return e}NextGroup(){return this.FromIndex=this.FromIndex+this.Count,this.FromIndex>0&&this.Group++,this.Count=this.CountInGroup(),this.MaxOnLeft=Math.floor(this.Count/2)+this.Count%2,0!=this.Count}}class z extends S{constructor(t){super(t)}Prepare(t){null==this.Children?this.Children=[]:this.Children.length=0}AddChildView(t){this.Children.push(t)}}class H extends A{constructor(t){super(),this.GetSupportsAssistants=()=>!1,this.Iterator=new V(t.State.NumberOfSiblings,t.State.NumberOfSiblingColumns),this.RealRoot=t,this.SpecialRoot=new z(d.Special(d.None,t.Element.Id,!0)),this.SpecialRoot.Level=this.RealRoot.Level,this.SpecialRoot.ParentNode=this.RealRoot,this.SpecialRoot.State.EffectiveLayoutStrategy=this;let e=t.State.RequireLayoutStrategy;this.SiblingSpacing=e.SiblingSpacing,this.ParentConnectorShield=e.ParentConnectorShield,this.ParentChildSpacing=e.ParentChildSpacing,this.ParentAlignment=e.ParentAlignment,this.ChildConnectorHookLength=e.ChildConnectorHookLength}NextGroup(){if(!this.Iterator.NextGroup())return!1;this.SpecialRoot.State.NumberOfSiblings=this.Iterator.Count,this.SpecialRoot.Prepare(2*this.RealRoot.State.NumberOfSiblingRows);for(let t=0;t<this.Iterator.Count;t++)this.SpecialRoot.AddChildView(this.RealRoot.Children[this.Iterator.FromIndex+t]);let t=this.RealRoot.Children[this.RealRoot.State.NumberOfSiblings+1+this.Iterator.Group];return this.SpecialRoot.AddChildView(t),y.CopyExteriorFrom(this.SpecialRoot.State,this.RealRoot.State),!0}PreProcessThisNode(t,e){throw new Error("NotSupportedException")}ApplyVerticalLayout(t,e){var r,n;if(null==this.SpecialRoot.State.SiblingsRowV)throw Error("SiblingsRowV is null");let o=null!=(n=null==(r=this.RealRoot.AssistantsRoot)?void 0:r.State.BranchExterior.Bottom)?n:this.SpecialRoot.State.SiblingsRowV.To;for(let e=0;e<this.Iterator.MaxOnLeft;e++){let r=0==e?this.ParentChildSpacing:this.SiblingSpacing,n=this.SpecialRoot.Children[e],i=n.State;y.MoveTo(i,i.Left,o+r);let a=new c(i.Top,i.Bottom),s=e+this.Iterator.MaxOnLeft;if(null==i.Size)throw Error("Size is null");if(s<this.Iterator.Count){let e=this.SpecialRoot.Children[s],n=e.State;if(y.MoveTo(n,n.Left,o+r),null==n.Size)throw Error("Size is null");n.Bottom>i.Bottom?y.MoveTo(i,i.Left,n.CenterV-i.Size.Height/2):n.Bottom<i.Bottom&&y.MoveTo(n,n.Left,i.CenterV-n.Size.Height/2),n.BranchExterior=h.from(n.Size,n.TopLeft),a=c.add(a,new c(n.Top,n.Bottom)),n.SiblingsRowV=a,y.VerticalLayout(t,e),o=n.BranchExterior.Bottom}i.BranchExterior=h.from(i.Size,i.TopLeft),i.SiblingsRowV=a,y.VerticalLayout(t,n),o=Math.max(o,i.BranchExterior.Bottom)}}ApplyHorizontalLayout(t,e){if(e.BranchRoot!=this.SpecialRoot)throw new Error("InvalidOperationException: Wrong root node received");let r=!0,n=0;for(let o=0;o<this.Iterator.Count;o++){let i=this.SpecialRoot.Children[o];if(y.HorizontalLayout(t,i),++n==this.Iterator.MaxOnLeft&&r){y.AlignHorizontalCenters(t,e,this.EnumerateSiblings(0,this.Iterator.MaxOnLeft)),r=!1,n=0;let a=Number.MIN_VALUE;for(let t=0;t<o;t++)a=Math.max(a,this.SpecialRoot.Children[t].State.BranchExterior.Right);a=Math.max(a,i.State.Right);let s=this.SpecialRoot.Children[this.SpecialRoot.State.NumberOfSiblings];if(null==this.SpecialRoot.Children[0].State.SiblingsRowV)throw Error("SiblingsRowV is null");if(null==i.State.SiblingsRowV)throw Error("SiblingsRowV is null");y.AdjustSpacer(s.State,a,this.SpecialRoot.Children[0].State.SiblingsRowV.From,this.SiblingSpacing,i.State.SiblingsRowV.To-this.SpecialRoot.Children[0].State.SiblingsRowV.From),e.Boundary.MergeFromNode(s)}}y.AlignHorizontalCenters(t,e,this.EnumerateSiblings(this.Iterator.MaxOnLeft,this.Iterator.Count))}EnumerateSiblings(t,e){const r=[];for(let n=t;n<e;n++)r.push(this.SpecialRoot.Children[n]);return r}RouteConnectors(t,e){throw new Error}}class D extends j{constructor(){super(...arguments),this.MaxGroups=4,this.GetSupportsAssistants=()=>!0}PreProcessThisNode(t,e){if(this.MaxGroups<=0)throw new Error("MaxGroups must be a positive value");if(e.ChildCount<=2*this.MaxGroups)super.PreProcessThisNode(t,e);else if(e.State.NumberOfSiblings=e.ChildCount,e.State.NumberOfSiblings>0){e.State.NumberOfSiblingColumns=this.MaxGroups,e.State.NumberOfSiblingRows=Math.floor(e.State.NumberOfSiblings/(2*this.MaxGroups)),e.State.NumberOfSiblings%(2*this.MaxGroups)!=0&&e.State.NumberOfSiblingRows++;let t=d.Special(d.None,e.Element.Id,!1);e.AddRegularChildBox(t);for(let t=0;t<e.State.NumberOfSiblingColumns;t++){let t=d.Special(d.None,e.Element.Id,!1);e.AddRegularChildBox(t)}if(e.State.NumberOfSiblingColumns>1){let t=d.Special(d.None,e.Element.Id,!1);e.AddRegularChildBox(t)}}}ApplyVerticalLayout(t,e){let r=e.BranchRoot;if(r.State.NumberOfSiblings<=2*this.MaxGroups)return void super.ApplyVerticalLayout(t,e);0==r.Level&&(r.State.SiblingsRowV=new c(r.State.Top,r.State.Bottom)),null!=r.AssistantsRoot&&(y.CopyExteriorFrom(r.AssistantsRoot.State,r.State),y.VerticalLayout(t,r.AssistantsRoot));let n=new H(r);for(;n.NextGroup();)y.VerticalLayout(t,n.SpecialRoot)}ApplyHorizontalLayout(t,e){let r=e.BranchRoot;if(r.State.NumberOfSiblings<=2*this.MaxGroups)return void super.ApplyHorizontalLayout(t,e);0==r.Level&&(r.State.SiblingsRowV=new c(r.State.Top,r.State.Bottom)),null!=r.AssistantsRoot&&y.HorizontalLayout(t,r.AssistantsRoot);let n=new H(r);for(;n.NextGroup();)y.HorizontalLayout(t,n.SpecialRoot);let o=r.State;if(r.Level>0){let n=0;if(r.State.NumberOfSiblingColumns>1){let t=r.Children[r.State.NumberOfSiblings+1].State.CenterH,e=r.Children[r.State.NumberOfSiblings+r.State.NumberOfSiblingColumns].State.CenterH,i=1==r.State.NumberOfSiblings||this.ParentAlignment==x.Center?t+(e-t)/2:this.ParentAlignment==x.Left?t+this.ChildConnectorHookLength:e-this.ChildConnectorHookLength;n=o.CenterH-i}else{let t=r.Children[1+r.State.NumberOfSiblings].State.CenterH;n=o.CenterH-t}y.MoveChildrenOnly(t,e,n)}if(r.Level>0){if(null==r.Children[0].State.SiblingsRowV)throw Error("SiblingsRowV is null");let e=r.State.NumberOfSiblings,n=r.Children[e];if(y.AdjustSpacer(n.State,o.CenterH-this.ParentConnectorShield/2,o.Bottom,this.ParentConnectorShield,r.Children[0].State.SiblingsRowV.From-o.Bottom),t.MergeSpacer(n),e++,e+=r.State.NumberOfSiblingColumns,r.State.NumberOfSiblingColumns>1){let n=r.Children[e],o=r.Children[r.State.NumberOfSiblings+1].State.TopLeft,i=r.Children[e-1].State.Right;y.AdjustSpacer(n.State,o.X,o.Y-this.ParentChildSpacing,i-o.X,this.ParentChildSpacing),t.MergeSpacer(n)}}}RouteConnectors(t,e){if(e.State.NumberOfSiblings<=2*this.MaxGroups)return void super.RouteConnectors(t,e);e.State.NumberOfSiblings,e.State.NumberOfSiblingColumns;e.State.NumberOfSiblingColumns;let r=[],n=e.State,o=n.CenterH,i=0;if(null==e.Children[0].State.SiblingsRowV)throw Error("SiblingsRowV is null");let a=e.Children[0].State.SiblingsRowV.From-n.Bottom;r[i++]=new E(new l(o,n.Bottom),new l(o,n.Bottom+a-this.ChildConnectorHookLength));let s=new V(e.State.NumberOfSiblings,e.State.NumberOfSiblingColumns);for(;s.NextGroup();){let t=e.Children[1+e.State.NumberOfSiblings+s.Group].State,n=t.CenterH,o=!0,a=0;for(let u=s.FromIndex;u<s.FromIndex+s.Count;u++){let h=o?e.Children[u].State.Right:e.Children[u].State.Left,d=e.Children[u].State.CenterV;r[i++]=new E(new l(n,d),new l(h,d)),++a==s.MaxOnLeft&&(a=0,o&&(r[1+e.State.NumberOfSiblings+s.Group]=new E(new l(t.CenterH,t.Top-this.ChildConnectorHookLength),new l(t.CenterH,e.Children[u].State.CenterV))),o=!o)}}if(i+=e.State.NumberOfSiblingColumns,e.State.NumberOfSiblingColumns>1){let t=e.Children[1+e.State.NumberOfSiblings].State,n=e.Children[1+e.State.NumberOfSiblings+e.State.NumberOfSiblingColumns-1].State;r[i]=new E(new l(t.CenterH,t.Top-this.ChildConnectorHookLength),new l(n.CenterH,n.Top-this.ChildConnectorHookLength))}e.State.Connector=new O(r)}}class F extends j{constructor(){super(...arguments),this.MaxSiblingsPerRow=4,this.GetSupportsAssistants=()=>!0}PreProcessThisNode(t,e){if(this.MaxSiblingsPerRow<=0||this.MaxSiblingsPerRow%2!=0)throw new Error("MaxSiblingsPerRow must be a positive even value");if(e.ChildCount<=this.MaxSiblingsPerRow)super.PreProcessThisNode(t,e);else if(e.State.NumberOfSiblings=e.ChildCount,e.State.NumberOfSiblings>0){let t=e.ChildCount%this.MaxSiblingsPerRow;e.State.NumberOfSiblingColumns=1+this.MaxSiblingsPerRow,e.State.NumberOfSiblingRows=Math.floor(e.ChildCount/this.MaxSiblingsPerRow),0!=t&&e.State.NumberOfSiblingRows++,e.State.NumberOfSiblings=e.ChildCount+e.State.NumberOfSiblingRows,t>0&&t<=Math.floor(this.MaxSiblingsPerRow/2)&&e.State.NumberOfSiblings--;let r=Math.floor(this.MaxSiblingsPerRow/2);for(;r<e.State.NumberOfSiblings;){let t=d.Special(d.None,e.Element.Id,!1);e.InsertRegularChildBoxByIndex(r,t),r+=e.State.NumberOfSiblingColumns}let n=d.Special(d.None,e.Element.Id,!1);e.AddRegularChildBox(n);for(let t=0;t<e.State.NumberOfSiblingRows;t++){let t=d.Special(d.None,e.Element.Id,!1);e.AddRegularChildBox(t)}}}ApplyVerticalLayout(t,e){let r=e.BranchRoot;if(r.State.NumberOfSiblings<=this.MaxSiblingsPerRow)return void super.ApplyVerticalLayout(t,e);0==r.Level&&(r.State.SiblingsRowV=new c(r.State.Top,r.State.Bottom)),null!=r.AssistantsRoot&&(y.CopyExteriorFrom(r.AssistantsRoot.State,r.State),y.VerticalLayout(t,r.AssistantsRoot));let n=new c(r.State.SiblingsRowV.From,null==r.AssistantsRoot?r.State.SiblingsRowV.To:r.State.BranchExterior.Bottom);for(let e=0;e<r.State.NumberOfSiblingRows;e++){let o=c.MinMax(),i=0==e?this.ParentChildSpacing:this.SiblingSpacing,a=e*r.State.NumberOfSiblingColumns,s=Math.min(a+r.State.NumberOfSiblingColumns,r.State.NumberOfSiblings);for(let t=a;t<s;t++){let e=r.Children[t];if(e.Element.IsSpecial)continue;let a=e.State,s=n.To+i;y.MoveTo(e.State,a.Left,s),e.State.BranchExterior=h.from(e.State.Size,e.State.TopLeft),o=c.add(o,new c(s,s+a.Size.Height))}o=new c(o.From,o.To);let l=Number.MIN_VALUE;for(let e=a;e<s;e++){let n=r.Children[e];n.State.SiblingsRowV=o,y.VerticalLayout(t,n),l=Math.max(l,n.State.BranchExterior.Bottom)}n=new c(o.From,Math.max(l,o.To));let u=a+Math.floor(r.State.NumberOfSiblingColumns/2);if(u<r.State.NumberOfSiblings){let t=e==r.State.NumberOfSiblingRows-1?r.Children[u-1].State.SiblingsRowV.To:n.To,o=r.Children[u].State;y.AdjustSpacer(o,0,n.From,this.ParentConnectorShield,t-n.From)}}}ApplyHorizontalLayout(t,e){let r=e.BranchRoot;if(r.State.NumberOfSiblings<=this.MaxSiblingsPerRow)return void super.ApplyHorizontalLayout(t,e);null!=r.AssistantsRoot&&y.HorizontalLayout(t,r.AssistantsRoot);for(let n=0;n<r.State.NumberOfSiblingColumns;n++){for(let e=0;e<r.State.NumberOfSiblingRows;e++){let o=e*r.State.NumberOfSiblingColumns+n;if(o>=r.State.NumberOfSiblings)break;let i=r.Children[o];y.HorizontalLayout(t,i)}y.AlignHorizontalCenters(t,e,this.EnumerateColumn(r,n))}let n=r.State,o=r.Children[Math.floor(r.State.NumberOfSiblingColumns/2)].State.CenterH,i=n.CenterH-o;y.MoveChildrenOnly(t,e,i);let a=r.Children[r.State.NumberOfSiblings];y.AdjustSpacer(a.State,n.CenterH-this.ParentConnectorShield/2,n.Bottom,this.ParentConnectorShield,r.Children[0].State.SiblingsRowV.From-n.Bottom),t.MergeSpacer(a);let s=this.ParentChildSpacing;for(let e=0;e<r.State.NumberOfSiblings;e+=r.State.NumberOfSiblingColumns){let n=r.Children[e].State,o=r.Children[Math.min(e+r.State.NumberOfSiblingColumns-1,r.State.NumberOfSiblings-1)].State,i=r.Children[1+r.State.NumberOfSiblings+Math.floor(e/r.State.NumberOfSiblingColumns)],l=o.Right>=a.State.Right?o.Right-n.Left:a.State.Right-n.Left;y.AdjustSpacer(i.State,n.Left,n.SiblingsRowV.From-s,l,s),t.MergeSpacer(i),s=this.SiblingSpacing}}EnumerateColumn(t,e){const r=[];for(let n=0;n<t.State.NumberOfSiblingRows;n++){let o=n*t.State.NumberOfSiblingColumns+e;if(o>=t.State.NumberOfSiblings)break;r.push(t.Children[o])}return r}RouteConnectors(t,e){if(e.State.NumberOfSiblings<=this.MaxSiblingsPerRow)return void super.RouteConnectors(t,e);let r=1+e.State.NumberOfSiblingRows;for(let t of e.Children)t.Element.IsSpecial||r++;let n=[],o=e.State,i=o.CenterH,a=e.Children[e.State.NumberOfSiblings-1].State.SiblingsRowV.From-this.ChildConnectorHookLength-o.Bottom;n[0]=new E(new l(i,o.Bottom),new l(i,o.Bottom+a));let s=1;for(let t=0;t<e.State.NumberOfSiblings;t++){let r=e.Children[t];if(!r.Element.IsSpecial){let t=r.State,e=t.CenterH;n[s++]=new E(new l(e,t.Top),new l(e,t.Top-this.ChildConnectorHookLength))}}let u=r-e.State.NumberOfSiblingRows-1;for(let t=1;t<r-e.State.NumberOfSiblingRows;t+=this.MaxSiblingsPerRow){let e=n[t],r=n[Math.min(t+this.MaxSiblingsPerRow-1,u)];r.From.X<n[0].From.X?n[s++]=new E(new l(e.To.X,e.To.Y),new l(n[0].To.X,e.To.Y)):n[s++]=new E(new l(e.To.X,e.To.Y),new l(r.To.X,e.To.Y))}e.State.Connector=new O(n)}}class k extends A{constructor(){super(...arguments),this.GetSupportsAssistants=()=>!0}PreProcessThisNode(t,e){if(this.ParentAlignment!=x.Left&&this.ParentAlignment!=x.Right)throw new Error("InvalidOperationException: Unsupported value for ParentAlignment");if(e.State.NumberOfSiblings=e.Element.IsCollapsed?0:e.ChildCount,e.State.NumberOfSiblings>0&&e.Level>0){e.State.NumberOfSiblingColumns=1,e.State.NumberOfSiblingRows=e.ChildCount;let t=d.Special(d.None,e.Element.Id,!1);e.AddRegularChildBox(t)}}ApplyVerticalLayout(t,e){let r=e.BranchRoot;0==r.Level&&(r.State.SiblingsRowV=new c(r.State.Top,r.State.Bottom)),null!=r.AssistantsRoot&&(y.CopyExteriorFrom(r.AssistantsRoot.State,r.State),y.VerticalLayout(t,r.AssistantsRoot));let n=new c(r.State.SiblingsRowV.From,null==r.AssistantsRoot?r.State.SiblingsRowV.To:r.State.BranchExterior.Bottom);for(let e=0;e<r.State.NumberOfSiblings;e++){let o=r.Children[e],i=o.State,a=n.To+(0==e?this.ParentChildSpacing:this.SiblingSpacing);y.MoveTo(o.State,i.Left,a),o.State.BranchExterior=h.from(o.State.Size,o.State.TopLeft);let s=new c(a,a+i.Size.Height);o=r.Children[e],o.State.SiblingsRowV=s,y.VerticalLayout(t,o);let l=o.State.BranchExterior.Bottom;n=new c(s.From,Math.max(l,s.To))}}ApplyHorizontalLayout(t,e){let r=e.BranchRoot,n=r.State;null!=r.AssistantsRoot&&y.HorizontalLayout(t,r.AssistantsRoot);for(let e=0;e<n.NumberOfSiblings;e++){let n=r.Children[e];y.HorizontalLayout(t,n)}let o=y.AlignHorizontalCenters(t,e,this.EnumerateColumn(r));if(r.Level>0&&r.ChildCount>0){let n,i=r.State;if(this.ParentAlignment==x.Left){n=i.CenterH+this.ParentConnectorShield/2-o.From}else{if(this.ParentAlignment!=x.Right)throw new Error("InvalidOperationException: Invalid ParentAlignment setting");n=i.CenterH-this.ParentConnectorShield/2-o.To}y.MoveChildrenOnly(t,e,n);let a=r.Level>0?r.Children[r.ChildCount-1]:null;if(null!=a){let e=r.State.Bottom,n=r.Children[r.ChildCount-2].State.Bottom;y.AdjustSpacer(a.State,i.CenterH-this.ParentConnectorShield/2,e,this.ParentConnectorShield,n-e),t.MergeSpacer(a)}}}EnumerateColumn(t){const e=[];for(let r=0;r<t.State.NumberOfSiblings;r++)e.push(t.Children[r]);return e}RouteConnectors(t,e){if(0==e.ChildCount)return;let r=1+e.State.NumberOfSiblings,n=Array(r),o=e.State,i=o.CenterH,a=e.Children[e.State.NumberOfSiblings-1].State.CenterV-e.State.Bottom;n[0]=new E(new l(i,o.Bottom),new l(i,o.Bottom+a));for(let t=0;t<e.State.NumberOfSiblings;t++){let r=e.Children[t].State,o=this.ParentAlignment==x.Left?r.Left:r.Right;n[1+t]=new E(new l(i,r.CenterV),new l(o,r.CenterV))}e.State.Connector=new O(n)}}(R=B||(B={}))[R.InvalidValue=0]="InvalidValue",R[R.SingleRowHorizontal=1]="SingleRowHorizontal",R[R.SingleColumnVertical=2]="SingleColumnVertical";var G=B;class X extends A{constructor(){super(),this.GetSupportsAssistants=()=>!1,this.Orientation=G.SingleRowHorizontal,this.ParentAlignment=x.InvalidValue,this.ChildConnectorHookLength=0,this.ParentConnectorShield=0,this.SiblingSpacing=5}PreProcessThisNode(t,e){if(e.State.NumberOfSiblings=e.Element.IsCollapsed?0:e.ChildCount,e.State.NumberOfSiblings>0&&this.Orientation!=G.SingleRowHorizontal&&this.Orientation!=G.SingleColumnVertical)throw new Error("InvalidOperationException: Unsupported value for orientation: "+this.Orientation)}ApplyVerticalLayout(t,e){let r=e.BranchRoot;if(0==r.Level&&(r.State.SiblingsRowV=new c(r.State.Top,r.State.Bottom)),0==r.State.NumberOfSiblings)return;let n=c.MinMax();if(this.Orientation==G.SingleRowHorizontal){let e=null==r.AssistantsRoot?r.State.SiblingsRowV.To+this.ParentChildSpacing:r.State.BranchExterior.Bottom+this.ParentChildSpacing;for(let t=0;t<r.State.NumberOfSiblings;t++){let o=r.Children[t],i=o.State;y.MoveTo(o.State,0,e),o.State.BranchExterior=h.from(o.State.Size,o.State.TopLeft),n=c.add(n,new c(e,e+i.Size.Height))}n=new c(n.From,n.To);for(let e=0;e<r.State.NumberOfSiblings;e++){let o=r.Children[e];o.State.SiblingsRowV=n,y.VerticalLayout(t,o)}}else if(this.Orientation==G.SingleColumnVertical){let e=new c(r.State.SiblingsRowV.From,r.State.SiblingsRowV.To);for(let n=0;n<r.State.NumberOfSiblings;n++){let o=r.Children[n],i=o.State,a=e.To+(0==n?this.ParentChildSpacing:this.SiblingSpacing);y.MoveTo(o.State,i.Left,a),o.State.BranchExterior=h.from(o.State.Size,o.State.TopLeft);let s=new c(a,a+i.Size.Height);o=r.Children[n],o.State.SiblingsRowV=s,y.VerticalLayout(t,o);let l=o.State.BranchExterior.Bottom;e=new c(s.From,Math.max(l,s.To))}}}ApplyHorizontalLayout(t,e){let r=e.BranchRoot;for(let e of r.Children)y.HorizontalLayout(t,e);if(r.ChildCount>0)if(this.Orientation==G.SingleRowHorizontal){let n=r.Children[r.State.NumberOfSiblings-1].State.Right-r.Children[0].State.Left;r.State.Size=new u(Math.max(r.State.Size.Width,n),r.State.Size.Height);let o=(r.Children[0].State.Left+r.Children[r.ChildCount-1].State.Right)/2,i=r.State.CenterH-o;y.MoveChildrenOnly(t,e,i)}else if(this.Orientation==G.SingleColumnVertical){y.AlignHorizontalCenters(t,e,r.Children);let n=r.Children[0].State.CenterH,o=r.State.CenterH-n;y.MoveChildrenOnly(t,e,o)}}RouteConnectors(t,e){}}var Y=Object.assign;const U=new u(5,5);class q extends P{constructor(t){super(),this.DataSource=t}}class W extends a.a.Component{constructor(){super(...arguments),this.state={lines:Array(),width:0,height:0,diagram:null,nodes:[],hidden:!0,boundaries:[],prevProps:null,renderIndex:0},this._mounted=!0,this._container=a.a.createRef(),this.onComputeBranchOptimizer=t=>{const{layout:e="linear"}=this.props;if(t.IsAssistantRoot){const{assistantLayout:t="assistants"}=this.props;return t instanceof A?"assistantCustom":t}return"smart"===e?W.getBranchOptimizerSmart(t):"stackers"===e?W.getBranchOptimizerStackers(t):e instanceof A?"custom":e},this._lastRenderIndex=0}static assignStrategies(t){const e=[];let r;return r=new j,r.ParentAlignment=x.Center,t.LayoutSettings.LayoutStrategies.set("linear",r),e.push(r),r=new F,r.ParentAlignment=x.Center,r.MaxSiblingsPerRow=2,t.LayoutSettings.LayoutStrategies.set("hanger2",r),e.push(r),r=new F,r.ParentAlignment=x.Center,r.MaxSiblingsPerRow=4,t.LayoutSettings.LayoutStrategies.set("hanger4",r),e.push(r),r=new k,r.ParentAlignment=x.Right,t.LayoutSettings.LayoutStrategies.set("singleColumnRight",r),e.push(r),r=new k,r.ParentAlignment=x.Left,t.LayoutSettings.LayoutStrategies.set("singleColumnLeft",r),e.push(r),r=new D,r.ParentAlignment=x.Center,r.MaxGroups=1,t.LayoutSettings.LayoutStrategies.set("fishbone1",r),e.push(r),r=new D,r.ParentAlignment=x.Center,r.MaxGroups=2,t.LayoutSettings.LayoutStrategies.set("fishbone2",r),e.push(r),r=new X,r.ParentAlignment=x.InvalidValue,r.Orientation=G.SingleRowHorizontal,r.ParentChildSpacing=10,t.LayoutSettings.LayoutStrategies.set("hstack",r),e.push(r),r=new X,r.ParentAlignment=x.InvalidValue,r.Orientation=G.SingleColumnVertical,r.ParentChildSpacing=10,t.LayoutSettings.LayoutStrategies.set("vstack",r),e.push(r),r=new X,r.ParentAlignment=x.InvalidValue,r.Orientation=G.SingleColumnVertical,r.SiblingSpacing=20,t.LayoutSettings.LayoutStrategies.set("vstackMiddle",r),e.push(r),r=new X,r.ParentAlignment=x.InvalidValue,r.Orientation=G.SingleColumnVertical,r.SiblingSpacing=50,t.LayoutSettings.LayoutStrategies.set("vstackTop",r),e.push(r),r=new N,r.ParentAlignment=x.Center,t.LayoutSettings.LayoutStrategies.set("assistants",r),e.push(r),t.LayoutSettings.DefaultLayoutStrategyId="vstack",t.LayoutSettings.DefaultAssistantLayoutStrategyId="assistants",e}static getDataSource(t){const{root:e,childNodesGetter:r,keyGetter:n,isAssistantGetter:o}=t,i=new Map,a=[],s=(t,e=null)=>{const l=n(t);a.push(l);const u=!!o&&o(t);i.set(l,{IsAssistant:u,Id:l,data:t,parentKey:e});for(const e of r(t))s(e,l)};s(e,null);return{GetDataItemFunc:t=>(t=>{const e=i.get(t);if(null==e)throw Error("Could not find item");return e})(t),GetParentKeyFunc:t=>{var e;return(null==(e=i.get(t))?void 0:e.parentKey)||null},AllDataItemIds:a}}static getBranchOptimizerStackers(t){return t.IsAssistantRoot?null:0===t.Level?"vstackTop":1===t.Level?"vstackMiddle":"hstack"}static getBranchOptimizerSmart(t){if(t.IsAssistantRoot)return null;let e=t.ChildCount;if(e<=1)return"vstack";let r=0;for(let n=0;n<e;n++)t.Children[n].ChildCount>0&&r++;return r<=1?e<=4?"vstack":e<=8?"fishbone1":"fishbone2":"hanger4"}componentWillUnmount(){this._mounted=!0}static getDerivedStateFromProps(t,e){if(t!==e.prevProps){const r=W.createDiagram(t),n=W.getPlaceholders(r,e.nodes);return Y(Y({diagram:r},n),{prevProps:t,renderIndex:e.renderIndex+1})}return{prevProps:t}}componentWillMount(){const t=W.getDerivedStateFromProps(this.props,this.state);this.setState(t)}componentWillReceiveProps(t){if(t!==this.props){const e=W.getDerivedStateFromProps(t,this.state);this.setState(e)}}static createDiagram(t){const{layout:e,assistantLayout:r,parentSpacing:n=40,siblingSpacing:o=30}=t,i=W.getDataSource(t),a=new v(i),s=new q(i);s.Boxes=a;const l=W.assignStrategies(s);e instanceof A&&s.LayoutSettings.LayoutStrategies.set("custom",e),r instanceof A&&s.LayoutSettings.LayoutStrategies.set("assistantCustom",r);for(const t of l)t.ChildConnectorHookLength=n/2,t.ParentChildSpacing=n,t.SiblingSpacing=o;return s}static getPlaceholders(t,e){const r=t.DataSource,n=[],o=new Map;for(const t of e)o.set(t.dataId,t);const i={left:0,top:0,width:"",height:""};for(const e of t.Boxes.BoxesById.values()){if(!e.IsDataBound)continue;const t=e.Id,a=e.DataId||"",s=r.GetDataItemFunc(a).data,l=o.get(a),u=(null==l?void 0:l.rect)||i;n.push({rect:{left:u.left,top:u.top,width:"auto",height:"auto"},data:s,dataId:e.DataId||String(t),boxId:t,assistant:e.IsAssistant})}return n.sort((t,e)=>t.boxId-e.boxId),{hidden:!0,nodes:n}}safelyDrawDiagram(){if(this.props!==this.state.prevProps)return;if(!this._mounted)return;const{diagram:t,renderIndex:e}=this.state,{debug:r}=this.props;e>this._lastRenderIndex&&(this._lastRenderIndex=e,t&&this.drawDiagram(t,r))}componentDidMount(){this.safelyDrawDiagram()}componentDidUpdate(){this.safelyDrawDiagram()}drawDiagram(t,e){if(t!==this.state.diagram)return;if(0===t.DataSource.AllDataItemIds.length)return;const r=new M(t),n=new Map,o=this._container.current;if(o&&o.querySelectorAll("[data-box-id]").forEach(t=>{const e=t.getAttribute("data-box-id");e&&n.set(parseInt(e),t)}),r.LayoutOptimizerFunc=this.onComputeBranchOptimizer,r.BoxSizeFunc=e=>{if(null==e)return U;const r=t.Boxes.BoxesByDataId.get(e);if(r){const t=n.get(r.Id);if(t){t.offsetWidth,t.offsetHeight;const e=t.getBoundingClientRect();return new u(e.width,e.height)}}return U},y.Apply(r),null==t.VisualTree)throw Error("VisualTree is null");const i=y.ComputeBranchVisualBoundingRect(t.VisualTree),a=-i.Left,s=-i.Top,l=[],h=[],d=[];t.VisualTree.IterateParentFirst(r=>{if(r.State.IsHidden)return!1;const n=r.Element;if(!n.IsDataBound)return!0;const o=r.State.TopLeft.X+a,i=r.State.TopLeft.Y+s,u=n.DataId||"",{data:c}=t.DataSource.GetDataItemFunc(u);if(l.push({rect:{left:o,top:i,width:n.Size.Width,height:n.Size.Height},data:c,dataId:u||String(n.Id),boxId:n.Id,assistant:n.IsAssistant}),e&&d.push({branchLeft:r.State.BranchExterior.Left,branchTop:r.State.BranchExterior.Top,left:r.State.BranchExterior.Left+a,top:r.State.BranchExterior.Top+s,width:r.State.BranchExterior.Size.Width,height:r.State.BranchExterior.Size.Height}),null!=r.State.Connector){const t=r.State.Connector.Segments;for(let e=0;e<t.length;e++){const r=t[e];let o,i="horizontal",l=n.IsAssistant,d=0,f=0;r.From.Y===r.To.Y?(i="horizontal",f=1,r.From.X<r.To.X?(o=r.From,d=r.To.X-r.From.X):(o=r.To,d=r.From.X-r.To.X)):(i="vertical",r.From.Y<r.To.Y?(o=r.From,f=r.To.Y-r.From.Y):(o=r.To,f=r.From.Y-r.To.Y)),h.push({direction:i,assistant:l,data:c,dataId:u,boxId:n.Id,index:e,rect:{left:o.X+a,top:o.Y+s,width:d,height:f}})}}return!0}),this.setState({width:i.Size.Width,height:i.Size.Height,lines:h,nodes:l,boundaries:d,hidden:!1})}render(){const{lines:t,width:e,height:r,nodes:n,hidden:o,boundaries:i}=this.state,{lineVerticalClassName:s,lineHorizontalClassName:l,lineHorizontalStyle:u,lineVerticalStyle:h,containerStyle:d,renderNode:c,renderNodeContainer:f,renderNodeLine:S,nodeContainerStyle:p,isValidNode:g}=this.props,m={vertical:s,horizontal:l},y={vertical:h,horizontal:u};return a.a.createElement("div",{style:Y({width:e,height:r,position:"relative"},d),ref:this._container},a.a.createElement("div",null,t.map(({rect:{width:t,height:e,left:r,top:n},data:i,assistant:s,direction:l,dataId:u,index:h})=>{if(!g(u))return null;const d={"data-line-assistant":s,"data-line-direction":l,className:m[l],key:u+"-"+h,style:Y({left:0,top:0,width:t,height:e,transform:`translate3d(${r}px, ${n}px, 0)`,position:"absolute"},y[l])};return"function"==typeof S?S(i,d,{hidden:o,direction:l}):(d.style.visibility=o?"hidden":"visible",d.style.pointerEvents=o?"none":"auto",a.a.createElement("div",Y({},d)))})),a.a.createElement("div",null,n.map(t=>{const{rect:{top:e,left:r,width:n,height:i},dataId:s,boxId:l,data:u}=t;if(!g(s))return null;const h=c(u),d={"data-box-id":String(l),children:h,key:s,style:Y({left:0,top:0,transform:`translate3d(${r}px, ${e}px, 0)`,position:"absolute"},p)};return"function"==typeof f?f(u,d,{hidden:o}):(d.style.visibility=o?"hidden":"visible",d.style.pointerEvents=o?"none":"auto",a.a.createElement("div",Y({},d)))})),a.a.createElement("div",null,i.map(({top:t,left:e,width:r,height:n,branchLeft:i,branchTop:s},l)=>a.a.createElement("div",{key:l,style:{transform:`translate3d(${e}px, ${t}px, 0)`,width:r,height:n,position:"absolute",top:0,left:0,zIndex:0,pointerEvents:"none",visibility:o?"hidden":"visible",background:"rgba(255,0,0,0.1)",border:"1px solid red"}},a.a.createElement("div",{style:{backgroundColor:"red",color:"white",display:"inline-block",padding:"0 2px"}},"(",+i.toFixed(2),",",+s.toFixed(2),")"," ",+r.toFixed(2),"x",+n.toFixed(2))))))}}var $=Object.assign;class K extends a.a.Component{constructor(){super(...arguments),this.state={transition:this.props.entranceTransition||"opacity 800ms",opacity:0,firstVisible:!1}}static getDerivedStateFromProps({context:t,defaultTransition:e="transform 800ms, opacity 800ms",entranceTransition:r="opacity 800ms"},n){return t.hidden?{opacity:0}:n.firstVisible?{opacity:1,transition:e}:{opacity:1,transition:r,firstVisible:!0}}render(){const{node:t,context:e,props:r,getStyle:n}=this.props,{opacity:o,transition:i}=this.state,s=n?n(t,r,e):null;return a.a.createElement("div",$($({},r),{style:$($($({},r.style),{opacity:o,transition:i}),s)}))}}e.p=W},"./node_modules/object-assign/index.js":function(t,e,r){"use strict";var n=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;function a(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(t){n[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var r,s,l=a(t),u=1;u<arguments.length;u++){for(var h in r=Object(arguments[u]))o.call(r,h)&&(l[h]=r[h]);if(n){s=n(r);for(var d=0;d<s.length;d++)i.call(r,s[d])&&(l[s[d]]=r[s[d]])}}return l}},"./node_modules/react/cjs/react.production.min.js":function(t,e,r){"use strict";var n=r("./node_modules/object-assign/index.js"),o="function"==typeof Symbol&&Symbol.for,i=o?Symbol.for("react.element"):60103,a=o?Symbol.for("react.portal"):60106,s=o?Symbol.for("react.fragment"):60107,l=o?Symbol.for("react.strict_mode"):60108,u=o?Symbol.for("react.profiler"):60114,h=o?Symbol.for("react.provider"):60109,d=o?Symbol.for("react.context"):60110,c=o?Symbol.for("react.forward_ref"):60112,f=o?Symbol.for("react.suspense"):60113,S=o?Symbol.for("react.memo"):60115,p=o?Symbol.for("react.lazy"):60116,g="function"==typeof Symbol&&Symbol.iterator;function m(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b={};function C(t,e,r){this.props=t,this.context=e,this.refs=b,this.updater=r||y}function v(){}function w(t,e,r){this.props=t,this.context=e,this.refs=b,this.updater=r||y}C.prototype.isReactComponent={},C.prototype.setState=function(t,e){if("object"!=typeof t&&"function"!=typeof t&&null!=t)throw Error(m(85));this.updater.enqueueSetState(this,t,e,"setState")},C.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},v.prototype=C.prototype;var L=w.prototype=new v;L.constructor=w,n(L,C.prototype),L.isPureReactComponent=!0;var B={current:null},R=Object.prototype.hasOwnProperty,x={key:!0,ref:!0,__self:!0,__source:!0};function O(t,e,r){var n,o={},a=null,s=null;if(null!=e)for(n in void 0!==e.ref&&(s=e.ref),void 0!==e.key&&(a=""+e.key),e)R.call(e,n)&&!x.hasOwnProperty(n)&&(o[n]=e[n]);var l=arguments.length-2;if(1===l)o.children=r;else if(1<l){for(var u=Array(l),h=0;h<l;h++)u[h]=arguments[h+2];o.children=u}if(t&&t.defaultProps)for(n in l=t.defaultProps)void 0===o[n]&&(o[n]=l[n]);return{$$typeof:i,type:t,key:a,ref:s,props:o,_owner:B.current}}function I(t){return"object"==typeof t&&null!==t&&t.$$typeof===i}var P=/\/+/g,E=[];function A(t,e,r,n){if(E.length){var o=E.pop();return o.result=t,o.keyPrefix=e,o.func=r,o.context=n,o.count=0,o}return{result:t,keyPrefix:e,func:r,context:n,count:0}}function N(t){t.result=null,t.keyPrefix=null,t.func=null,t.context=null,t.count=0,10>E.length&&E.push(t)}function T(t,e,r){return null==t?0:function t(e,r,n,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case i:case a:l=!0}}if(l)return n(o,e,""===r?"."+_(e,0):r),1;if(l=0,r=""===r?".":r+":",Array.isArray(e))for(var u=0;u<e.length;u++){var h=r+_(s=e[u],u);l+=t(s,h,n,o)}else if(null===e||"object"!=typeof e?h=null:h="function"==typeof(h=g&&e[g]||e["@@iterator"])?h:null,"function"==typeof h)for(e=h.call(e),u=0;!(s=e.next()).done;)l+=t(s=s.value,h=r+_(s,u++),n,o);else if("object"===s)throw n=""+e,Error(m(31,"[object Object]"===n?"object with keys {"+Object.keys(e).join(", ")+"}":n,""));return l}(t,"",e,r)}function _(t,e){return"object"==typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+(""+t).replace(/[=:]/g,(function(t){return e[t]}))}(t.key):e.toString(36)}function M(t,e){t.func.call(t.context,e,t.count++)}function j(t,e,r){var n=t.result,o=t.keyPrefix;t=t.func.call(t.context,e,t.count++),Array.isArray(t)?V(t,n,r,(function(t){return t})):null!=t&&(I(t)&&(t=function(t,e){return{$$typeof:i,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(t,o+(!t.key||e&&e.key===t.key?"":(""+t.key).replace(P,"$&/")+"/")+r)),n.push(t))}function V(t,e,r,n,o){var i="";null!=r&&(i=(""+r).replace(P,"$&/")+"/"),T(t,j,e=A(e,i,n,o)),N(e)}var z={current:null};function H(){var t=z.current;if(null===t)throw Error(m(321));return t}var D={ReactCurrentDispatcher:z,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:B,IsSomeRendererActing:{current:!1},assign:n};e.Children={map:function(t,e,r){if(null==t)return t;var n=[];return V(t,n,null,e,r),n},forEach:function(t,e,r){if(null==t)return t;T(t,M,e=A(null,null,e,r)),N(e)},count:function(t){return T(t,(function(){return null}),null)},toArray:function(t){var e=[];return V(t,e,null,(function(t){return t})),e},only:function(t){if(!I(t))throw Error(m(143));return t}},e.Component=C,e.Fragment=s,e.Profiler=u,e.PureComponent=w,e.StrictMode=l,e.Suspense=f,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D,e.cloneElement=function(t,e,r){if(null==t)throw Error(m(267,t));var o=n({},t.props),a=t.key,s=t.ref,l=t._owner;if(null!=e){if(void 0!==e.ref&&(s=e.ref,l=B.current),void 0!==e.key&&(a=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(h in e)R.call(e,h)&&!x.hasOwnProperty(h)&&(o[h]=void 0===e[h]&&void 0!==u?u[h]:e[h])}var h=arguments.length-2;if(1===h)o.children=r;else if(1<h){u=Array(h);for(var d=0;d<h;d++)u[d]=arguments[d+2];o.children=u}return{$$typeof:i,type:t.type,key:a,ref:s,props:o,_owner:l}},e.createContext=function(t,e){return void 0===e&&(e=null),(t={$$typeof:d,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:h,_context:t},t.Consumer=t},e.createElement=O,e.createFactory=function(t){var e=O.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:c,render:t}},e.isValidElement=I,e.lazy=function(t){return{$$typeof:p,_ctor:t,_status:-1,_result:null}},e.memo=function(t,e){return{$$typeof:S,type:t,compare:void 0===e?null:e}},e.useCallback=function(t,e){return H().useCallback(t,e)},e.useContext=function(t,e){return H().useContext(t,e)},e.useDebugValue=function(){},e.useEffect=function(t,e){return H().useEffect(t,e)},e.useImperativeHandle=function(t,e,r){return H().useImperativeHandle(t,e,r)},e.useLayoutEffect=function(t,e){return H().useLayoutEffect(t,e)},e.useMemo=function(t,e){return H().useMemo(t,e)},e.useReducer=function(t,e,r){return H().useReducer(t,e,r)},e.useRef=function(t){return H().useRef(t)},e.useState=function(t){return H().useState(t)},e.version="16.13.1"},"./node_modules/react/index.js":function(t,e,r){"use strict";t.exports=r("./node_modules/react/cjs/react.production.min.js")},"./spec/utils/TestDataGen.ts":function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r("./dist/index.js");class o{constructor(t){}Next(t){return Math.floor(Math.random()*t)}}class i{GenerateDataItems(t,e,r){for(let n of this.GenerateRandomDataItems(e,r))t.Items.set(n.Id,n)}GenerateRandomDataItems(t,e){if(t<0)throw new Error("ArgumentOutOfRangeException: "+t+" - Count must be zero or positive");let r=new o(0),n=[];for(let e=0;e<t;e++)n.push({Id:e.toString(),Date1:new Date,ParentId:null,String1:null,String2:null,IsAssistant:!1});let i=1,a=1;for(;i<t;){let e=15+a+r.Next(2*a);for(let o=i;o<i+e&&o<t;o++){let t=i-1-r.Next(a);n[o].ParentId=n[t].Id}i+=e,a=e}for(let t=0;t<n.length/2;t++){let t=r.Next(n.length),e=r.Next(n.length),o=n[t];n[t]=n[e],n[e]=o}if(e>0){let t=Math.min(n.length,Math.round(Math.ceil(n.length*e/100)));for(let e=0;e<t;e++)n[r.Next(n.length)].IsAssistant=!0}return n}static GenerateBoxSizes(t){let e=new o(0);for(let r of t.BoxesById.values())r.IsSpecial||(r.Size=new n.Size(50+e.Next(50),50+e.Next(50)))}}},"./spec/utils/TestDataSource.ts":function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));class n{constructor(){this.Items=new Map,this.GetParentKeyFunc=t=>this.GetParentKey(t),this.GetDataItemFunc=t=>this.GetDataItem(t)}GetParentKey(t){var e;return(null==(e=this.Items.get(t))?void 0:e.ParentId)||null}GetDataItem(t){const e=this.Items.get(t);if(!e)throw Error("Could not find itemId");return e}get AllDataItemIds(){return[...this.Items.keys()].sort()}}},"./src/VanillaExample.ts":function(t,e,r){"use strict";r.r(e);var n=r("./lib/index.ts"),o=r("./spec/utils/TestDataSource.ts"),i=r("./spec/utils/TestDataGen.ts");class a{constructor(){this.diagram=null,this.dataSource=null,this.suppressRootBox=!1,this.totalBoxCount=20,this.percentAssistants=10,this.onLayoutStateChanged=(t,e)=>{t.CurrentOperation===n.k.PreprocessVisualTree&&this.renderBoxes()},this.buildChart(!0)}boxClick(t){var e;const r=null==(e=this.diagram)?void 0:e.Boxes.BoxesById.get(t);r&&(r.IsCollapsed=!r.IsCollapsed,this.positionBoxes())}buildChart(t){t&&this.initDiagram(),this.positionBoxes()}collapseAllBoxes(t,e){for(const r of t.BoxesByDataId.values())r.IsSpecial||(r.IsCollapsed=e)}generateData(){const t=this.totalBoxCount,e=this.percentAssistants,r=new o.a;if((new i.a).GenerateDataItems(r,t,e),this.suppressRootBox){r.Items.delete("0");for(const t of r.Items.values())"0"===t.ParentId&&(t.ParentId=null)}return r}initDiagram(){$("#myDiagramDiv").html('<div id="myConnectors" class="chartConnectorsPlane"/>');const t=this.generateData();this.dataSource=t;const e=new n.b(t);$("#CollapseAllOnRebuild")[0].checked&&this.collapseAllBoxes(e,!0);const r=this.diagram=new n.d;r.Boxes=e;const o=new n.h;o.ParentAlignment=n.c.Center,r.LayoutSettings.LayoutStrategies.set("linear",o);let i=new n.j;i.ParentAlignment=n.c.Center,i.MaxSiblingsPerRow=2,r.LayoutSettings.LayoutStrategies.set("hanger2",i),i=new n.j,i.ParentAlignment=n.c.Center,i.MaxSiblingsPerRow=4,r.LayoutSettings.LayoutStrategies.set("hanger4",i);let a=new n.l;a.ParentAlignment=n.c.Right,r.LayoutSettings.LayoutStrategies.set("singleColumnRight",a),a=new n.l,a.ParentAlignment=n.c.Left,r.LayoutSettings.LayoutStrategies.set("singleColumnLeft",a);let s=new n.i;s.ParentAlignment=n.c.Center,s.MaxGroups=1,r.LayoutSettings.LayoutStrategies.set("fishbone1",s),s=new n.i,s.ParentAlignment=n.c.Center,s.MaxGroups=2,r.LayoutSettings.LayoutStrategies.set("fishbone2",s);let l=new n.o;l.ParentAlignment=n.c.InvalidValue,l.Orientation=n.n.SingleRowHorizontal,l.ParentChildSpacing=10,r.LayoutSettings.LayoutStrategies.set("hstack",l);let u=new n.o;u.ParentAlignment=n.c.InvalidValue,u.Orientation=n.n.SingleColumnVertical,u.ParentChildSpacing=10,r.LayoutSettings.LayoutStrategies.set("vstack",u),u=new n.o,u.ParentAlignment=n.c.InvalidValue,u.Orientation=n.n.SingleColumnVertical,u.SiblingSpacing=20,r.LayoutSettings.LayoutStrategies.set("vstackMiddle",u),u=new n.o,u.ParentAlignment=n.c.InvalidValue,u.Orientation=n.n.SingleColumnVertical,u.SiblingSpacing=50,r.LayoutSettings.LayoutStrategies.set("vstackTop",u);let h=new n.e;h.ParentAlignment=n.c.Center,r.LayoutSettings.LayoutStrategies.set("assistants",h),r.LayoutSettings.DefaultLayoutStrategyId="fishbone1",r.LayoutSettings.DefaultAssistantLayoutStrategyId="assistants"}getBoxLevel(t,e){let r=0;for(;e.ParentId>0;){const n=t.BoxesById.get(e.ParentId);if(!n)break;e=n,r++}return r}renderBoxes(){var t,e,r;let n=null==(t=this.diagram)?void 0:t.Boxes,o=this.dataSource;if(null==n)throw Error("BoxContainer is null");if(null==o)throw Error("DataSource is null");const i=[],a=[];null==(r=null==(e=this.diagram)?void 0:e.VisualTree)||r.IterateParentFirst(t=>{let e=t.Element;if(e.IsDataBound){let r=$("#box"+e.Id);if(r.length>0){let n=$("#exp"+e.Id);return t.State.IsHidden?(r.hide(),n.length>0&&n.hide()):(r.show(),n.length>0&&n.show()),!0}if(t.State.IsHidden)return!0;if(null==n)throw Error("BoxContainer is null");const o=this.getBoxLevel(n,e),s=[null,"chartBoxTop","chartBoxMiddle","chartBoxLower"][o]||"chartBoxLowest",l=[null,"Top","Middle","Lower"][o]||String(o),u=document.createElement("div");if(u.className=s,u.id="box"+e.Id,u.style.position="absolute",u.style.width="150px",u.style.height="auto",u.innerText=`${l} - Box #${e.Id}, Data #${e.DataId}, Asst: ${e.IsAssistant}`,u.addEventListener("click",()=>this.boxClick(e.Id)),i.push(u),t.ChildCount>0||null!=t.AssistantsRoot){const t=document.createElement("div");t.id="exp"+e.Id,t.className="expander",t.addEventListener("click",()=>this.boxClick(e.Id)),a.push(t)}e.Size=this.getBoxElementSize(e.Id)}return!0});const s=document.querySelector("#myDiagramDiv");if(s){for(const t of a)s.appendChild(t);for(const t of i)s.appendChild(t)}}getBranchOptimizerName(t){const e=document.querySelector("input[name='SelectBranchOptimizer']:checked");return(this["branchOptimizer"+(null==e?void 0:e.value)]||this.branchOptimizerAllLinear)(t)}branchOptimizerAllLinear(t){return t.IsAssistantRoot?null:"linear"}branchOptimizerAllHanger2(t){return t.IsAssistantRoot?null:"hanger2"}branchOptimizerAllHanger4(t){return t.IsAssistantRoot?null:"hanger4"}branchOptimizerAllFishbone1(t){return t.IsAssistantRoot?null:"fishbone1"}branchOptimizerAllFishbone2(t){return t.IsAssistantRoot?null:"fishbone2"}branchOptimizerAllSingleColumnLeft(t){return t.IsAssistantRoot?null:"singleColumnRight"}branchOptimizerAllSingleColumnRight(t){return t.IsAssistantRoot?null:"singleColumnLeft"}branchOptimizerStackers(t){return t.IsAssistantRoot?null:0===t.Level?"vstackTop":1===t.Level?"vstackMiddle":"hstack"}branchOptimizerSmart(t){if(t.IsAssistantRoot)return null;let e=t.ChildCount;if(e<=1)return"vstack";let r=0;for(let n=0;n<e;n++)t.Children[n].ChildCount>0&&r++;return r<=1?e<=4?"vstack":e<=8?"fishbone1":"fishbone2":"hanger4"}boxSizeFunc(t){var e,r,n,o;const i=null==(r=null==(e=this.diagram)?void 0:e.Boxes.BoxesByDataId.get(t))?void 0:r.Id;if(null==i)throw Error("BoxId is null");const a=null==(o=null==(n=this.diagram)?void 0:n.Boxes.BoxesById.get(i))?void 0:o.Size;if(null==a)throw Error("Size is null");return a}getBoxElementSize(t){return new n.m(160,50)}positionBoxes(){$("#myConnectors").html("");let t=this.diagram;if(null==t)throw Error("Diagram is null");let e=new n.g(t);if(e.OperationChanged=this.onLayoutStateChanged,e.BoxSizeFunc=t=>{if(null==t)throw Error("DataId is null");return this.boxSizeFunc(t)},e.LayoutOptimizerFunc=t=>this.getBranchOptimizerName(t),n.f.Apply(e),null==t.VisualTree)throw Error("diagram.VisualTree is null");const r=n.f.ComputeBranchVisualBoundingRect(t.VisualTree),o=document.querySelector("#myDiagramDiv");if(null==o)throw Error("Cannot find #myDiagramDiv");o.style.width=r.Size.Width+"px",o.style.height=r.Size.Height+"px";let i=-r.Left,a=-r.Top;const s=[];t.VisualTree.IterateParentFirst((function(t){if(t.State.IsHidden)return!1;let e=t.Element;if(e.IsDataBound){const r=document.querySelector("#box"+e.Id);if(r){let n=t.State.TopLeft.X+i,o=t.State.TopLeft.Y+a;if(r.style.left=n+"px",r.style.top=o+"px",r.style.width=t.State.Size.Width+"px",r.style.height=t.State.Size.Height+"px",t.ChildCount>0||null!=t.AssistantsRoot){const r=document.querySelector("#exp"+e.Id);r&&(n=t.State.Right+i-15,o=t.State.Bottom+a-15,r.style.left=n+"px",r.style.top=o+"px",e.IsCollapsed?r.innerText="▼":r.innerText="△")}}}if(null!=t.State.Connector)for(let e=0;e<t.State.Connector.Segments.length;e++){let r,n,o,l,u=t.State.Connector.Segments[e];u.From.Y===u.To.Y?(r="chartHLine",l=1,u.From.X<u.To.X?(n=u.From,o=u.To.X-u.From.X):(n=u.To,o=u.From.X-u.To.X)):(r="chartVLine",o=1,u.From.Y<u.To.Y?(n=u.From,l=u.To.Y-u.From.Y):(n=u.To,l=u.From.Y-u.To.Y)),t.IsAssistantRoot&&(r+="Dotted");const h=document.createElement("div");h.className=r,h.style.top=n.Y+a+"px",h.style.left=n.X+i+"px",h.style.width=o+"px",h.style.height=l+"px",s.push(h)}return!0}));const l=document.querySelector("#myConnectors");if(null==l)throw Error("myConnectors is null");for(const t of s)l.appendChild(t)}}document.addEventListener("DOMContentLoaded",()=>{if(console.log("loaded!"),window.chartApp)return;const t=window.chartApp=new a;window.changedSuppressRootBox=function(e){t.suppressRootBox=e.checked,t.buildChart(!0)},window.clickCollapseAll=function(e){if(null==t.diagram)throw Error("chartApp.diagram is null");t.collapseAllBoxes(t.diagram.Boxes,!0),t.buildChart(!1)},window.clickExpandAll=function(e){if(null==t.diagram)throw Error("chartApp.diagram is null");t.collapseAllBoxes(t.diagram.Boxes,!1),t.buildChart(!1)},window.clickOptimizer=function(e){t.buildChart(!1)},window.clickDataCounts=function(e){let r=e.value;"small"===r?(t.totalBoxCount=20,t.percentAssistants=0):"small-a"===r?(t.totalBoxCount=20,t.percentAssistants=10):"large"===r?(t.totalBoxCount=200,t.percentAssistants=0):"large-a"===r?(t.totalBoxCount=200,t.percentAssistants=10):"huge-a"===r&&(t.totalBoxCount=1e3,t.percentAssistants=5),t.buildChart(!0)}})}});
//# sourceMappingURL=vanilla.js.map